<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="generator" content="Asciidoctor 0.1.4"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Ceph 4 Installation Lab</title><style>@import url(http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.0/css/font-awesome.css);
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #003b6b; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #00579e; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #333333; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: Arial, sans-serif; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Arial, sans-serif; font-weight: normal; font-style: normal; color: #7b2d00; text-rendering: optimizeLegibility; margin-top: 0.5em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #ff6b15; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; color: #003426; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; list-style-position: outside; font-family: Arial, sans-serif; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3em; font-weight: bold; }
dl dd { margin-bottom: 0.75em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: black; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #e15200; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #e15200; }

blockquote, blockquote p { line-height: 1.6; color: #333333; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Print styles.  Inlined to avoid required HTTP connection: www.phpied.com/delay-loading-your-print-css/ Credit to Paul Irish and HTML5 Boilerplate (html5boilerplate.com)
*/
.print-only { display: none !important; }

@media print { * { background: transparent !important; color: #000 !important; /* Black prints faster: h5bp.com/s */ box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; /* h5bp.com/t */ }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #d8d8ce; }
/* Change -webkit-linear-gradient colors to  #a70000 and remove gradient */
table thead, table tfoot { background: -webkit-linear-gradient(top, #a70000, #a70000); font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: white; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #6d6e71; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #edf2f2; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

a:hover, a:focus { text-decoration: underline; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; padding: 3px 2px 1px 2px; white-space: nowrap; background-color: #eeeeee; border: 1px solid #dddddd; -webkit-border-radius: 0; border-radius: 0; text-shadow: none; }

pre, pre > code { line-height: 1.6; color: black; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }

kbd.keyseq { color: #333333; }

kbd:not(.keyseq) { display: inline-block; color: black; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

kbd kbd:first-child { margin-left: 0; }

kbd kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: black; }

b.button:before { content: '[ '; }

b.button:after { content: ' ]'; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 1.5em; padding-right: 1.5em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#header { margin-bottom: 2.5em; }
#header > h1 { color: #7b2d00; font-weight: normal; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #333333; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }

#toctitle { color: #003b6b; }

@media only screen and (min-width: 768px) { body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: .90em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; border-width: 0; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }

#content #toctitle { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-size: 1em; padding-left: 0.125em; }

#footer { max-width: 100%; background-color: none; padding: 1.25em; }

#footer-text { color: black; line-height: 1.44; }

.sect1 { padding-bottom: 1.25em; }

.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #7b2d00; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #622400; }

.imageblock, .literalblock, .listingblock, .mathblock, .verseblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }

.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #333333; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }

.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #aaaaaa; box-shadow: 0 1px 8px #aaaaaa; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #003b6b; margin-top: 0; line-height: 1.6; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre:not([class]), .listingblock pre:not([class]) { background: #eeeeee; }
.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border-width: 1px; border-style: dashed; border-color: #666666; -webkit-border-radius: 0; border-radius: 0; padding: 1.25em 1.5625em 1.125em 1.5625em; word-wrap: break-word; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock pre > code, .literalblock pre[class] > code, .listingblock pre > code, .listingblock pre[class] > code { display: block; }
@media only screen { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.72em; } }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.81em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.9em; } }

.listingblock pre.highlight { padding: 0; }
.listingblock pre.highlight > code { padding: 1.25em 1.5625em 1.125em 1.5625em; }

.listingblock > .content { position: relative; }

.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }

.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.sass:before { content: "sass"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }

table.pyhltable { border: 0; margin-bottom: 0; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }

.quoteblock { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 0.75em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: 0.8125em; color: #e15200; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }

table thead th, table tfoot th { font-weight: bold; }

table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 0; border-radius: 0; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }

table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }

table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }

table.tableblock td .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }

th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }

th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }

th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }

th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }

th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }

tbody tr th { display: table-cell; line-height: 1.4; background: -webkit-linear-gradient(top, #add386, #90b66a); }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: white; font-weight: bold; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.375em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.375em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .8em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.qanda > ol > li > p > em:only-child { color: #004985; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }

.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #00579e; color: #004176; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum { display: inline-block; color: white !important; background-color: black; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { border-bottom: 1px solid #dddddd; }

#toctitle { color: #00406F; font-weight: normal; margin-top: 1.5em; }

.sidebarblock { border-color: #aaa; }

code { -webkit-border-radius: 4px; border-radius: 4px; }

p.tableblock.header { color: #6d6e71; }</style><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/3.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/sunburst.min.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script><script>hljs.initHighlightingOnLoad()</script></head><body class="article toc2 toc-left"><div id="header"><div id="toc" class="toc2"><div id="toctitle">Table of Contents</div><ul class="sectlevel1">
<li><a href="#_ceph_4_installation_lab">Ceph 4 Installation Lab</a></li>
<li><a href="#_install_ceph">1. Install Ceph</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_configure_workstation_node">1.1. Configure workstation node</a></li>
<li><a href="#_create_the_ceph_nodes">1.2. Create the Ceph nodes</a></li>
<li><a href="#_prepare_to_install_ceph_using_ansible">1.3. Prepare to Install Ceph Using Ansible</a></li>
<li><a href="#_install_ceph_4_using_ansible">1.4. Install Ceph 4 Using Ansible</a></li>
</ul>
</li>
<li><a href="#_complete_post_installation_steps">2. Complete Post-Installation Steps</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_display_ceph_osd_tree_and_monitor_map">2.1. Display Ceph OSD Tree and Monitor Map</a></li>
<li><a href="#_examine_containers_on_ceph_node">2.2. Examine Containers on Ceph Node</a></li>
<li><a href="#_manage_ceph_monitor_daemon_services">2.3. Manage Ceph Monitor Daemon Services</a></li>
</ul>
</li>
</ul></div></div><div id="content"><div class="sect1"><h2 id="_ceph_4_installation_lab">Ceph 4 Installation Lab</h2><div class="sectionbody"><div class="paragraph"><p>In this lab, you first install a Ceph<sup>&#174;</sup> 4 cluster using Ansible<sup>&#174;</sup>. You allow the hosts to trust any certificates signed by a lab-specific CA. Next, you install Red Hat<sup>&#174;</sup> Ceph Storage using Ansible, perform post-installation configuration steps, and verify that your Ceph cluster is working properly.</p></div></div></div>
<div class="sect1"><h2 id="_install_ceph">1. Install Ceph</h2><div class="sectionbody"><div class="sect2"><h3 id="_configure_workstation_node">1.1. Configure workstation node</h3><div class="paragraph"><p>On Ceph 4 we require a VM to install grafana-server. For this lab we will create a workstation VM connected to VLAN 30 (storage) and to the provisioning network (to access to the VM easily and for internet DNS).</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Run <code>./setup-env-workstation.sh</code> on the hypervisor</p><div class="listingblock"><div class="content"><pre class="nowrap">[root@hypervisor ~]# ./setup-env-workstation.sh</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  2144  100  2144    0     0   184k      0 --:--:-- --:--:-- --:--:--  209k
Formatting 'workstation.qcow2', fmt=qcow2 size=64424509440 cluster_size=65536 lazy_refcounts=off refcount_bits=16
[   0.0] Examining rhel-8.qcow2
**********

Summary of changes:

/dev/sda1: This partition will be resized from 7.8G to 60.0G.  The
filesystem xfs on /dev/sda1 will be expanded using the ‘xfs_growfs’
method.

**********
[   2.3] Setting up initial partition table on workstation.qcow2
[   2.9] Copying /dev/sda1
 100% ⟦▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒⟧ 00:00
[  20.8] Expanding /dev/sda1 using the ‘xfs_growfs’ method

Resize operation completed with no errors.  Before deleting the old disk,
carefully check that the resized disk boots and works correctly.
[   0.0] Examining the guest ...
[   4.6] Setting a random seed
[   4.6] Setting the machine ID in /etc/machine-id
[   4.6] Setting the hostname: workstation.example.com
[   4.6] Uninstalling packages: cloud-init
[   6.8] Copying: /tmp/hosts to /etc/
[   6.8] Copying: /tmp/ifcfg-eth0 to /etc/sysconfig/network-scripts/
[   6.8] Copying: /tmp/ifcfg-eth0.30 to /etc/sysconfig/network-scripts/
[   6.8] Copying: /tmp/ifcfg-eth1 to /etc/sysconfig/network-scripts/
[   6.8] Copying: /tmp/open.repo to /etc/yum.repos.d/
[   6.9] Setting passwords
[   8.2] SELinux relabelling
[  20.6] Finishing off
Domain workstation defined from /root/host-workstation.xml

Domain workstation started</pre></div></div></li></ol></div></div>
<div class="sect2"><h3 id="_create_the_ceph_nodes">1.2. Create the Ceph nodes</h3><div class="olist arabic"><ol class="arabic"><li><p>Run <code>./setup-env-ceph4-osp16.sh</code> from the hypervisor</p><div class="listingblock"><div class="content"><pre class="nowrap">[root@hypervisor ~]# ./setup-env-ceph4-osp16.sh</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">&lt;&lt;OMITTED&gt;&gt;
Domain ceph-node01 defined from /root/host-ceph-node01.xml

Domain ceph-node02 defined from /root/host-ceph-node02.xml

Domain ceph-node03 defined from /root/host-ceph-node03.xml

Domain ceph-node01 started

Domain ceph-node02 started

Domain ceph-node03 started</pre></div></div></li></ol></div></div>
<div class="sect2"><h3 id="_prepare_to_install_ceph_using_ansible">1.3. Prepare to Install Ceph Using Ansible</h3><div class="paragraph"><p>In this section, you enable the required software repositories and install the <code>ceph-ansible</code> package on the <code>workstation</code> host. Then you use Ansible, which is installed with the <code>ceph-ansible package</code>, to create an <code>admin</code> user for use by the <code>ceph-ansible</code> installer.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Access to the workstation</p><div class="listingblock"><div class="content"><pre class="nowrap">[root@hypervisor ~]# ssh-copy-id root@192.0.2.249
[root@hypervisor ~]# ssh root@192.0.2.249</pre></div></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="icon-note" title="Note"></i></td><td class="content">Remember password is <code>r3dh4t1!</code></td></tr></table></div></li><li><p>On the workstation node, list the configured software repositories:</p><div class="listingblock"><div class="content"><pre class="highlight nowrap"><code class="sh language-sh">[root@workstation ~]# dnf repolist</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">repo id                                                                                                   repo name
ansible-2.9-for-rhel-8-x86_64-rpms                                                                        ansible-2.9-for-rhel-8-x86_64-rpms
fast-datapath-for-rhel-8-x86_64-rpms                                                                      fast-datapath-for-rhel-8-x86_64-rpms
openstack-16.1-for-rhel-8-x86_64-rpms                                                                     openstack-16.1-for-rhel-8-x86_64-rpms
rhceph-4-tools-for-rhel-8-x86_64-rpms                                                                     rhceph-4-tools-for-rhel-8-x86_64-rpms
rhel-8-for-x86_64-appstream-eus-rpms                                                                      rhel-8-for-x86_64-appstream-eus-rpms
rhel-8-for-x86_64-baseos-eus-rpms                                                                         rhel-8-for-x86_64-baseos-eus-rpms
rhel-8-for-x86_64-highavailability-eus-rpms                                                               rhel-8-for-x86_64-highavailability-eus-rpms</code></pre></div></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="icon-note" title="Note"></i></td><td class="content">To install <code>ceph-ansible</code> is required the repository <code>rhceph-4-tools-for-rhel-8-x86_64-rpm</code>.</td></tr></table></div></li><li><p>Install the <code>ceph-ansible</code> package on the <code>workstation</code> host:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ~]# dnf -y install ceph-ansible</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">Running transaction
  Preparing        :                                                                                                                                                                                           1/1
  Installing       : ceph-ansible-4.0.14-1.el8cp.noarch                                                                                                                                                        1/1
  Verifying        : ceph-ansible-4.0.14-1.el8cp.noarch                                                                                                                                                        1/1

Installed:
  ceph-ansible-4.0.14-1.el8cp.noarch

Complete!</code></pre></div></div></li><li><p>Create <code>/etc/hosts</code> with the IPs</p><div class="listingblock"><div class="content"><pre class="nowrap">[root@workstation ~]# cat &gt;&gt; /etc/hosts &lt;&lt;EOF
172.18.0.61 ceph-node01 ceph-node01.example.com
172.18.0.62 ceph-node02 ceph-node02.example.com
172.18.0.63 ceph-node03 ceph-node03.example.com
EOF</pre></div></div></li><li><p>Configure the prerequisites using Ansible:</p><div class="olist loweralpha"><ol class="loweralpha" type="a"><li><p>Create an inventory file called <code>ceph-nodes</code>:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="texinfo language-texinfo">[all]
ceph-node01
ceph-node02
ceph-node03</code></pre></div></div></li><li><p>Create an Ansible Playbook called <code>ceph-preqs.yaml</code>:</p><div class="listingblock"><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">---
- name: Ceph Installation Pre-requisites
  hosts: all
  gather_facts: no
  vars:
  remote_user: root
  ignore_errors: yes
  tasks:

  - name: Create the admin user
    user:
      name: admin
      generate_ssh_key: yes
      ssh_key_bits: 2048
      ssh_key_file: .ssh/id_rsa
      password: $6$mZKDrweZ5e04Hcus$97I..Zb0Ywh1lQefdCRxGh2PJ/abNU/LIN7zp8d2E.uYUSmx1RLokyzYS3mUTpipvToZbYKyfMqdP6My7yYJW1

  - name: Create sudo file for admin user
    lineinfile:
      path: /etc/sudoers.d/admin
      state: present
      create: yes
      line: "admin ALL=(root) NOPASSWD:ALL"
      owner: root
      group: root
      mode: 0440

  - name: Push ssh key to hosts
    authorized_key:
      user: admin
      key: "{{ lookup('file', '/root/.ssh/id_rsa.pub') }}"
      state: present

  - name: Copy certificate
    copy:
      src: /etc/pki/ca-trust/source/anchors/classroom.crt
      dest: /etc/pki/ca-trust/source/anchors/classroom.crt

  - name:  Extract CA cert into trust chain
    command: /bin/update-ca-trust update
</code></pre></div></div></li></ol></div></li><li><p>Download classroom certificate</p><div class="listingblock"><div class="content"><pre class="nowrap">[root@workstation ~]# curl http://classroom.example.com/ca.crt -o /etc/pki/ca-trust/source/anchors/classroom.crt
[root@workstation ~]# update-ca-trust update</pre></div></div></li><li><p>Copy ssh key to all the ceph-nodes</p><div class="listingblock"><div class="content"><pre class="nowrap">[root@workstation ~]# ssh-keygen
[root@workstation ~]# ssh-copy-id 172.18.0.61
[root@workstation ~]# ssh-copy-id 172.18.0.62
[root@workstation ~]# ssh-copy-id 172.18.0.63</pre></div></div></li><li><p>Execute the <code>ceph-preqs.yml</code> playbook:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ~]# ansible-playbook -i ceph-nodes ceph-preqs.yaml</code></pre></div></div></li><li><p>Create a <code>~/.ssh/config</code> file to configure SSH:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="texinfo language-texinfo">Host ceph*
  User admin</code></pre></div></div></li></ol></div></div>
<div class="sect2"><h3 id="_install_ceph_4_using_ansible">1.4. Install Ceph 4 Using Ansible</h3><div class="paragraph"><p>In this section, you install Ceph 4 on three monitor nodes and three OSD nodes.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Change to the <code>ceph-ansible</code> installation directory:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ~]# cd /usr/share/ceph-ansible/</code></pre></div></div></li><li><p>Create the Ansible inventory file:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ceph-ansible]# vi hosts</code></pre></div></div>
<div class="listingblock"><div class="title">Example Ansible Inventory File</div><div class="content"><pre class="highlight"><code class="texinfo language-texinfo">[mons]
ceph-node01
ceph-node02
ceph-node03

[mgrs]
ceph-node01
ceph-node02
ceph-node03

[rgws]
ceph-node01
ceph-node02
ceph-node03

[osds]
ceph-node01
ceph-node02
ceph-node03

[grafana-server]
localhost ansible_connection=local</code></pre></div></div></li><li><p>Create the <code>ansible.cfg</code> file for Ansible:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ceph-ansible]# mv ansible.cfg ansible.cfg.orig
[root@workstation ceph-ansible]# vi ansible.cfg</code></pre></div></div>
<div class="listingblock"><div class="title">Example <code>ansible.cfg</code> File</div><div class="content"><pre class="highlight"><code class="texinfo language-texinfo">[defaults]
inventory     = /usr/share/ceph-ansible/hosts
action_plugins = /usr/share/ceph-ansible/plugins/actions
filter_plugins = /usr/share/ceph-ansible/plugins/filter
roles_path = /usr/share/ceph-ansible/roles
log_path = /var/log/ansible.log
timeout = 60
host_key_checking = False
retry_files_enabled = False
retry_files_save_path = /usr/share/ceph-ansible/ansible-retry
[privilege_escalation]
become=True
become_method=sudo
become_user=root
become_ask_pass=False</code></pre></div></div></li><li><p>Create the <code>all.yml</code> file:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ceph-ansible]# vi group_vars/all.yml</code></pre></div></div>
<div class="listingblock"><div class="title">Example <code>/usr/share/ceph-ansible/group_vars/all.yml</code> File</div><div class="content"><pre class="highlight"><code class="texinfo language-texinfo">---
monitor_interface: eth0.30
radosgw_interface: eth0.30
journal_size: 5120
public_network: 172.18.0.0/24
ceph_docker_image: rhceph/rhceph-4-rhel8
ceph_docker_image_tag: latest
containerized_deployment: true
ceph_docker_registry: classroom.example.com:5000
ceph_origin: repository
ceph_repository: rhcs
ceph_repository_type: local
ceph_rhcs_version: 4
dashboard_admin_user: admin
dashboard_admin_password: r3dh4t1!
grafana_admin_user: admin
grafana_admin_password: r3dh4t1!
ceph_conf_overrides:
  global:
    mon_pg_warn_min_per_osd: 0</code></pre></div></div></li><li><p>Create the <code>osds.yml</code> file:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ceph-ansible]# vi group_vars/osds.yml</code></pre></div></div>
<div class="listingblock"><div class="title">Example <code>/usr/share/ceph-ansible/group_vars/osds.yml</code> File</div><div class="content"><pre class="highlight"><code class="texinfo language-texinfo">---
copy_admin_key: true

devices:
  - /dev/vdb
  - /dev/vdc

ceph_osd_docker_memory_limit: 1g
ceph_osd_docker_cpu_limit: 1</code></pre></div></div></li><li><p>Create the <code>mons.yml</code> file:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ceph-ansible]# vi group_vars/mons.yml</code></pre></div></div>
<div class="listingblock"><div class="title">Example <code>/usr/share/ceph-ansible/group_vars/mons.yml</code> File</div><div class="content"><pre class="highlight"><code class="texinfo language-texinfo">---
ceph_mon_docker_memory_limit: 1g
ceph_mon_docker_cpu_limit: 1
</code></pre></div></div></li><li><p>Create the <code>mgrs.yml</code> file:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ceph-ansible]# vi group_vars/mgrs.yml</code></pre></div></div>
<div class="listingblock"><div class="title">Example <code>/usr/share/ceph-ansible/group_vars/mgrs.yml</code> File</div><div class="content"><pre class="highlight"><code class="texinfo language-texinfo">---
ceph_mgr_docker_memory_limit: 1g
ceph_mgr_docker_cpu_limit: 1
</code></pre></div></div></li><li><p>Create the <code>rgws.yml</code> file:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ceph-ansible]# vi group_vars/rgws.yml</code></pre></div></div>
<div class="listingblock"><div class="title">Example <code>/usr/share/ceph-ansible/group_vars/rgws.yml</code> File</div><div class="content"><pre class="highlight"><code class="texinfo language-texinfo">---
ceph_rgw_docker_memory_limit: 1g
ceph_rgw_docker_cpu_limit: 1
</code></pre></div></div></li><li><p>Create the <code>site-docker.yml</code> playbook:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ceph-ansible]# cp site-docker.yml.sample site-docker.yml</code></pre></div></div></li><li><p>Execute the playbook to begin the installation:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ceph-ansible]# ansible-playbook site-docker.yml</code></pre></div></div>
<div class="admonitionblock important"><table><tr><td class="icon"><i class="icon-important" title="Important"></i></td><td class="content"><div class="paragraph"><p>Most of the plays in the <code>site-docker.yml</code> playbook are configured to exit if they encounter a failure. If this happens, fix the error condition and rerun the playbook.</p></div></td></tr></table></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">&lt;&lt;OMITTED&gt;&gt;
TASK [show ceph status for cluster ceph] **************************************************************************************************************************************************************************
ok: [ceph-node01 -&gt; ceph-node01] =&gt; {
    "msg": [
        "  cluster:",
        "    id:     798e8408-da52-4900-b8b7-808242429930",
        "    health: HEALTH_WARN",
        "            clock skew detected on mon.ceph-node02, mon.ceph-node03",
        " ",
        "  services:",
        "    mon: 3 daemons, quorum ceph-node01,ceph-node02,ceph-node03 (age 7m)",
        "    mgr: ceph-node02(active, starting, since 2s), standbys: ceph-node01, ceph-node03",
        "    osd: 6 osds: 6 up (since 4m), 6 in (since 4m)",
        "    rgw: 3 daemons active (ceph-node01.rgw0, ceph-node02.rgw0, ceph-node03.rgw0)",
        " ",
        "  task status:",
        " ",
        "  data:",
        "    pools:   4 pools, 32 pgs",
        "    objects: 191 objects, 2.7 KiB",
        "    usage:   6.0 GiB used, 48 GiB / 54 GiB avail",
        "    pgs:     32 active+clean",
        " "
    ]
}

PLAY RECAP ********************************************************************************************************************************************************************************************************
ceph-node01                : ok=490  changed=54   unreachable=0    failed=0    skipped=479  rescued=0    ignored=1
ceph-node02                : ok=420  changed=39   unreachable=0    failed=0    skipped=430  rescued=0    ignored=1
ceph-node03                : ok=429  changed=41   unreachable=0    failed=0    skipped=423  rescued=0    ignored=1
localhost                  : ok=128  changed=22   unreachable=0    failed=0    skipped=247  rescued=0    ignored=1</code></pre></div></div>
<div class="ulist"><ul><li><p>Your values for <code>ok</code> and <code>changed</code> may not be the same those shown in this example, but make sure that the <code>failed</code> value is <code>0</code>.</p></li></ul></div></li></ol></div></div></div></div>
<div class="sect1"><h2 id="_complete_post_installation_steps">2. Complete Post-Installation Steps</h2><div class="sectionbody"><div class="paragraph"><p>In this section, you configure the <code>workstation</code> host as a Ceph administration node:</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Install the <code>ceph-common</code> software package:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ~]# dnf -y install ceph-common</code></pre></div></div></li><li><p>Copy the Ceph configuration and administrative keyring to the <code>workstation</code> host:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ~]# scp root@ceph-node01:/etc/ceph/ceph.conf /etc/ceph/
[root@workstation ~]# scp root@ceph-node01:/etc/ceph/ceph.client.admin.keyring /etc/ceph/</code></pre></div></div>
<div class="ulist"><ul><li><p>The output from these commands is not shown here.</p></li></ul></div></li><li><p>Examine the status of the Ceph cluster to verify your access to it:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ~]# ceph -s</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight"><code class="texinfo language-texinfo">  cluster:
    id:     798e8408-da52-4900-b8b7-808242429930
    health: HEALTH_WARN
            clock skew detected on mon.ceph-node02, mon.ceph-node03

  services:
    mon: 3 daemons, quorum ceph-node01,ceph-node02,ceph-node03 (age 49m)
    mgr: ceph-node02(active, since 41m), standbys: ceph-node01, ceph-node03
    osd: 6 osds: 6 up (since 46m), 6 in (since 46m)
    rgw: 3 daemons active (ceph-node01.rgw0, ceph-node02.rgw0, ceph-node03.rgw0)

  task status:

  data:
    pools:   4 pools, 32 pgs
    objects: 191 objects, 2.7 KiB
    usage:   6.0 GiB used, 48 GiB / 54 GiB avail
    pgs:     32 active+clean</code></pre></div></div></li><li><p>Check the health of the Ceph cluster:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ~]# ceph health</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight"><code class="texinfo language-texinfo">HEALTH_OK</code></pre></div></div>
<div class="admonitionblock important"><table><tr><td class="icon"><i class="icon-important" title="Important"></i></td><td class="content"><div class="paragraph"><p>If you receive a <code>clock skew</code> warning, this is not uncommon in VM environments. To achieve optimum time synchronization, all VMs must be configured to synchronize the time from the physical host that they are running on.</p></div></td></tr></table></div></li></ol></div>
<div class="sect2"><h3 id="_display_ceph_osd_tree_and_monitor_map">2.1. Display Ceph OSD Tree and Monitor Map</h3><div class="paragraph"><p>In this section, you examine the current OSD tree and monitor map.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Examine the contents of the current OSD tree:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ~]# ceph osd tree</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight"><code class="texinfo language-texinfo">ID CLASS WEIGHT  TYPE NAME            STATUS REWEIGHT PRI-AFF
-1       0.05273 root default
-7       0.01758     host ceph-node01
 0   hdd 0.00879         osd.0            up  1.00000 1.00000
 3   hdd 0.00879         osd.3            up  1.00000 1.00000
-5       0.01758     host ceph-node02
 1   hdd 0.00879         osd.1            up  1.00000 1.00000
 4   hdd 0.00879         osd.4            up  1.00000 1.00000
-3       0.01758     host ceph-node03
 2   hdd 0.00879         osd.2            up  1.00000 1.00000
 5   hdd 0.00879         osd.5            up  1.00000 1.00000</code></pre></div></div>
<div class="ulist"><ul><li><p>Note that there are three OSD nodes running, each with two OSDs.</p></li><li><p>By default, all of the OSDs are defined with a class of <code>hdd</code>.</p></li><li><p>In advanced installations, additional classes are likely to be used to identify devices such as SSD-based disks.</p></li><li><p>Also note that the numbering of the OSDs is stochastic and yours may be different.</p></li></ul></div></li><li><p>Display the current Ceph monitor map:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ~]# ceph mon dump</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight"><code class="texinfo language-texinfo">dumped monmap epoch 1
epoch 1
fsid 798e8408-da52-4900-b8b7-808242429930
last_changed 2020-06-11 06:46:54.493633
created 2020-06-11 06:46:54.493633
min_mon_release 14 (nautilus)
0: [v2:172.18.0.61:3300/0,v1:172.18.0.61:6789/0] mon.ceph-node01
1: [v2:172.18.0.62:3300/0,v1:172.18.0.62:6789/0] mon.ceph-node02
2: [v2:172.18.0.63:3300/0,v1:172.18.0.63:6789/0] mon.ceph-node03</code></pre></div></div></li></ol></div></div>
<div class="sect2"><h3 id="_examine_containers_on_ceph_node">2.2. Examine Containers on Ceph Node</h3><div class="paragraph"><p>In this section, you log in to one of the <code>ceph-node01</code> hosts to examine the containers running on the hosts. Then you use <code>podman stats</code> to monitor the containers' CPU, memory, network, and disk IO usage statistics.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>List the running Podman containers:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[root@workstation ~]# ssh ceph-node01
[admin@ceph-node01 ~]$ sudo podman ps</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">CONTAINER ID  IMAGE                                                    COMMAND  CREATED         STATUS             PORTS  NAMES
6e5fc689ab83  classroom.example.com:5000/rhceph/rhceph-4-rhel8:latest           50 minutes ago  Up 50 minutes ago         ceph-rgw-ceph-node01-rgw0
df013bae667f  classroom.example.com:5000/rhceph/rhceph-4-rhel8:latest           51 minutes ago  Up 51 minutes ago         ceph-osd-3
44169f287608  classroom.example.com:5000/rhceph/rhceph-4-rhel8:latest           51 minutes ago  Up 51 minutes ago         ceph-osd-0
75a5da280787  classroom.example.com:5000/rhceph/rhceph-4-rhel8:latest           53 minutes ago  Up 53 minutes ago         ceph-mgr-ceph-node01
40e86a72827f  classroom.example.com:5000/rhceph/rhceph-4-rhel8:latest           54 minutes ago  Up 54 minutes ago         ceph-mon-ceph-node01</code></pre></div></div>
<div class="ulist"><ul><li><p>There are five containers running:</p><div class="ulist"><ul><li><p>One Ceph MGR container: <code>ceph-mgr-ceph-node01</code></p></li><li><p>One Ceph MON container: <code>ceph-mon-ceph-node01</code></p></li><li><p>One Ceph RGW container: <code>ceph-rgw-ceph-node01</code></p></li><li><p>Two Ceph OSD cintainers: <code>ceph-osd-X</code></p></li></ul></div></li></ul></div></li><li><p>Monitor the Podman containers' statistics:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[admin@ceph-node01 ~]$ sudo podman stats</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">ID             NAME                        CPU %   MEM USAGE / LIMIT   MEM %    NET IO    BLOCK IO            PIDS
40e86a72827f   ceph-mon-ceph-node01        2.88%   131MB / 1.074GB     12.20%   -- / --   41.88MB / 319.8MB   28
44169f287608   ceph-osd-0                  4.80%   75.38MB / 1.918GB   3.93%    -- / --   38.19MB / 37.57MB   60
6e5fc689ab83   ceph-rgw-ceph-node01-rgw0   2.81%   82.27MB / 1.074GB   7.66%    -- / --   18.71MB / 0B        591
75a5da280787   ceph-mgr-ceph-node01        8.37%   328.3MB / 1.074GB   30.57%   -- / --   28.35MB / 0B        47
df013bae667f   ceph-osd-3                  4.55%   69.68MB / 1.918GB   3.63%    -- / --   19.97MB / 44.71MB   60</code></pre></div></div></li></ol></div></div>
<div class="sect2"><h3 id="_manage_ceph_monitor_daemon_services">2.3. Manage Ceph Monitor Daemon Services</h3><div class="paragraph"><p>The Ceph daemon containers are managed by <code>systemd</code>, so starting, stopping, and checking their status are all performed using a common and well-understood interface.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Examine the <code>systemd</code> services:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[admin@ceph-node01 ~]$ sudo systemctl | grep "ceph-.*.service"</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight"><code class="texinfo language-texinfo">ceph-mgr@ceph-node01.service                                                                                                         loaded active running   Ceph Manager
ceph-mon@ceph-node01.service                                                                                                         loaded active running   Ceph Monitor
ceph-osd@0.service                                                                                                                   loaded active running   Ceph OSD
ceph-osd@3.service                                                                                                                   loaded active running   Ceph OSD
ceph-radosgw@rgw.ceph-node01.rgw0.service                                                                                            loaded active running   Ceph RGW</code></pre></div></div></li><li><p>Examine the status of each service:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">[admin@ceph-node01 ~]$ sudo systemctl status ceph*@*.service</code></pre></div></div>
<div class="ulist"><ul><li><p>The output from this command is not shown here.</p></li></ul></div></li></ol></div></div></div></div></div><div id="footer"><div id="footer-text"><br>Build Version: 1.6.7   :   Last updated 2020-09-20 04:59:02 EDT</div></div></body></html>