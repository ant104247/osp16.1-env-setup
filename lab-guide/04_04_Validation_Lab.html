<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="generator" content="Asciidoctor 0.1.4"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Deployment Validation Lab</title><style>@import url(http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.0/css/font-awesome.css);
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #003b6b; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #00579e; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #333333; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: Arial, sans-serif; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Arial, sans-serif; font-weight: normal; font-style: normal; color: #7b2d00; text-rendering: optimizeLegibility; margin-top: 0.5em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #ff6b15; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; color: #003426; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; list-style-position: outside; font-family: Arial, sans-serif; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3em; font-weight: bold; }
dl dd { margin-bottom: 0.75em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: black; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #e15200; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #e15200; }

blockquote, blockquote p { line-height: 1.6; color: #333333; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Print styles.  Inlined to avoid required HTTP connection: www.phpied.com/delay-loading-your-print-css/ Credit to Paul Irish and HTML5 Boilerplate (html5boilerplate.com)
*/
.print-only { display: none !important; }

@media print { * { background: transparent !important; color: #000 !important; /* Black prints faster: h5bp.com/s */ box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; /* h5bp.com/t */ }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #d8d8ce; }
/* Change -webkit-linear-gradient colors to  #a70000 and remove gradient */
table thead, table tfoot { background: -webkit-linear-gradient(top, #a70000, #a70000); font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: white; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #6d6e71; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #edf2f2; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

a:hover, a:focus { text-decoration: underline; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; padding: 3px 2px 1px 2px; white-space: nowrap; background-color: #eeeeee; border: 1px solid #dddddd; -webkit-border-radius: 0; border-radius: 0; text-shadow: none; }

pre, pre > code { line-height: 1.6; color: black; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }

kbd.keyseq { color: #333333; }

kbd:not(.keyseq) { display: inline-block; color: black; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

kbd kbd:first-child { margin-left: 0; }

kbd kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: black; }

b.button:before { content: '[ '; }

b.button:after { content: ' ]'; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 1.5em; padding-right: 1.5em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#header { margin-bottom: 2.5em; }
#header > h1 { color: #7b2d00; font-weight: normal; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #333333; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }

#toctitle { color: #003b6b; }

@media only screen and (min-width: 768px) { body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: .90em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; border-width: 0; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }

#content #toctitle { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-size: 1em; padding-left: 0.125em; }

#footer { max-width: 100%; background-color: none; padding: 1.25em; }

#footer-text { color: black; line-height: 1.44; }

.sect1 { padding-bottom: 1.25em; }

.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #7b2d00; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #622400; }

.imageblock, .literalblock, .listingblock, .mathblock, .verseblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }

.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #333333; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }

.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #aaaaaa; box-shadow: 0 1px 8px #aaaaaa; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #003b6b; margin-top: 0; line-height: 1.6; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre:not([class]), .listingblock pre:not([class]) { background: #eeeeee; }
.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border-width: 1px; border-style: dashed; border-color: #666666; -webkit-border-radius: 0; border-radius: 0; padding: 1.25em 1.5625em 1.125em 1.5625em; word-wrap: break-word; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock pre > code, .literalblock pre[class] > code, .listingblock pre > code, .listingblock pre[class] > code { display: block; }
@media only screen { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.72em; } }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.81em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.9em; } }

.listingblock pre.highlight { padding: 0; }
.listingblock pre.highlight > code { padding: 1.25em 1.5625em 1.125em 1.5625em; }

.listingblock > .content { position: relative; }

.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }

.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.sass:before { content: "sass"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }

table.pyhltable { border: 0; margin-bottom: 0; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }

.quoteblock { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 0.75em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: 0.8125em; color: #e15200; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }

table thead th, table tfoot th { font-weight: bold; }

table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 0; border-radius: 0; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }

table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }

table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }

table.tableblock td .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }

th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }

th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }

th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }

th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }

th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }

tbody tr th { display: table-cell; line-height: 1.4; background: -webkit-linear-gradient(top, #add386, #90b66a); }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: white; font-weight: bold; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.375em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.375em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .8em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.qanda > ol > li > p > em:only-child { color: #004985; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }

.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #00579e; color: #004176; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum { display: inline-block; color: white !important; background-color: black; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { border-bottom: 1px solid #dddddd; }

#toctitle { color: #00406F; font-weight: normal; margin-top: 1.5em; }

.sidebarblock { border-color: #aaa; }

code { -webkit-border-radius: 4px; border-radius: 4px; }

p.tableblock.header { color: #6d6e71; }</style><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/3.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/sunburst.min.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script><script>hljs.initHighlightingOnLoad()</script></head><body class="article toc2 toc-left"><div id="header"><h1>Deployment Validation Lab</h1><div id="toc" class="toc2"><div id="toctitle">Table of Contents</div><ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_containerized_deployment">1. Containerized deployment</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_controller">1.1. Controller</a></li>
<li><a href="#_compute">1.2. Compute</a></li>
</ul>
</li>
<li><a href="#_post_deployment_tasks">2. Post Deployment Tasks</a></li>
<li><a href="#_create_tenant_network">3. Create Tenant Network</a></li>
<li><a href="#_create_flavor_modify_security_group_and_upload_image">4. Create Flavor, Modify Security Group, and Upload Image</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_create_flavor_in_overcloud">4.1. Create Flavor in Overcloud</a></li>
<li><a href="#_modify_default_security_group">4.2. Modify Default Security Group</a></li>
<li><a href="#_upload_image">4.3. Upload Image</a></li>
</ul>
</li>
<li><a href="#_launch_test_instance_and_verify_access">5. Launch Test Instance and Verify Access</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_launch_instance">5.1. Launch Instance</a></li>
<li><a href="#_assign_floating_ip_address_to_test_instance">5.2. Assign Floating IP Address to Test Instance</a></li>
<li><a href="#_connect_to_test_instance">5.3. Connect to Test Instance</a></li>
</ul>
</li>
<li><a href="#_review_neutron_configuration_with_ovn">6. Review Neutron Configuration with OVN</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_ovn_on_controller">6.1. OVN on Controller</a></li>
<li><a href="#_ovn_on_compute_nodes">6.2. OVN on Compute Nodes</a></li>
</ul>
</li>
<li><a href="#_packet_switching_and_tracing">7. Packet Switching and Tracing</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#_switching">7.1. Switching</a></li>
</ul>
</li>
</ul></div></div><div id="content"><div class="sect1"><h2 id="_introduction">Introduction</h2><div class="sectionbody"><div class="paragraph"><p>In the previous lab you deployed an overcloud with network isolation and OVN. The next step is to validate the deployment and perform some post-installations tasks.</p></div></div></div>
<div class="sect1"><h2 id="_containerized_deployment">1. Containerized deployment</h2><div class="sectionbody"><div class="paragraph"><p>As was indicated before, the OpenStack components are containerized using Podman containers.</p></div>
<div class="sect2"><h3 id="_controller">1.1. Controller</h3><div class="olist arabic"><ol class="arabic"><li><p>Login to the overcloud controller node:</p><div class="listingblock"><div class="title">[undercloud]</div><div class="content"><pre class="nowrap">(overcloud) [stack@undercloud ~]$ ssh heat-admin@overcloud-controller-0.ctlplane</pre></div></div></li><li><p>Check the Red Hat OpenStack Platform version</p><div class="listingblock"><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ cat /etc/rhosp-release</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">Red Hat OpenStack Platform release 16.1.0 GA (Train)</pre></div></div></li><li><p>Check the Red Hat Enterprise Linux version</p><div class="listingblock"><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ cat /etc/system-release</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">Red Hat Enterprise Linux release 8.2 (Ootpa)</pre></div></div></li><li><p>List containers running on the overcloud controller:</p><div class="listingblock"><div class="title">[overcloud-controller-0]</div><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ sudo podman ps</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">CONTAINER ID  IMAGE                                                                                  COMMAND               CREATED         STATUS             PORTS  NAMES
201058830deb  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-nova-api:16.1-47            kolla_start           42 minutes ago  Up 42 minutes ago         nova_api_cron
26cc98102e65  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-swift-proxy-server:16.1-44  kolla_start           42 minutes ago  Up 42 minutes ago         swift_proxy
3319b26d0c67  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-nova-api:16.1-47            kolla_start           42 minutes ago  Up 42 minutes ago         nova_metadata
e54c606697ed  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-nova-api:16.1-47            kolla_start           42 minutes ago  Up 42 minutes ago         nova_api
8b8a1571fd6f  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-glance-api:16.1-41          kolla_start           42 minutes ago  Up 42 minutes ago         glance_api
b0bf72f61eee  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-placement-api:16.1-48       kolla_start           42 minutes ago  Up 42 minutes ago         placement_api
9e0bfdb8a16d  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-ovn-controller:16.1-46      kolla_start           42 minutes ago  Up 42 minutes ago         ovn_controller
ab93ed4b5cab  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-swift-object:16.1-45        kolla_start           43 minutes ago  Up 42 minutes ago         swift_rsync
695ccd26665f  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-swift-object:16.1-45        kolla_start           43 minutes ago  Up 43 minutes ago         swift_object_updater
bf1709a07b50  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-swift-object:16.1-45        kolla_start           43 minutes ago  Up 43 minutes ago         swift_object_server
3fb7a4ef4c3f  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-swift-object:16.1-45        kolla_start           43 minutes ago  Up 43 minutes ago         swift_object_replicator
50555984627f  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-swift-proxy-server:16.1-44  kolla_start           43 minutes ago  Up 43 minutes ago         swift_object_expirer
3b604052b6db  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-swift-object:16.1-45        kolla_start           43 minutes ago  Up 43 minutes ago         swift_object_auditor
a2df0929741e  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-swift-container:16.1-45     kolla_start           43 minutes ago  Up 43 minutes ago         swift_container_updater
529dc915e83f  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-swift-container:16.1-45     kolla_start           43 minutes ago  Up 43 minutes ago         swift_container_server
a96b01889709  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-swift-container:16.1-45     kolla_start           43 minutes ago  Up 43 minutes ago         swift_container_replicator
66fbaff814d3  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-swift-container:16.1-45     kolla_start           43 minutes ago  Up 43 minutes ago         swift_container_auditor
f0c062f6a404  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-swift-account:16.1-44       kolla_start           43 minutes ago  Up 43 minutes ago         swift_account_server
15a39c3fb3ce  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-swift-account:16.1-44       kolla_start           43 minutes ago  Up 43 minutes ago         swift_account_replicator
27b747f02f0c  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-swift-account:16.1-44       kolla_start           43 minutes ago  Up 43 minutes ago         swift_account_reaper
f4878f3c9820  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-swift-account:16.1-44       kolla_start           43 minutes ago  Up 43 minutes ago         swift_account_auditor
0eb5c3b181a7  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-nova-novncproxy:16.1-46     kolla_start           43 minutes ago  Up 43 minutes ago         nova_vnc_proxy
2e86f83395ed  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-nova-scheduler:16.1-44      kolla_start           43 minutes ago  Up 43 minutes ago         nova_scheduler
c53d01613c9b  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-nova-conductor:16.1-45      kolla_start           43 minutes ago  Up 43 minutes ago         nova_conductor
05bf94aa2ee8  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-neutron-server-ovn:16.1-44  kolla_start           43 minutes ago  Up 43 minutes ago         neutron_api
5551e3c245c8  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-cron:16.1-50                kolla_start           43 minutes ago  Up 43 minutes ago         logrotate_crond
4b227e121f73  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-heat-engine:16.1-45         kolla_start           43 minutes ago  Up 43 minutes ago         heat_engine
17930c91e39a  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-heat-api:16.1-45            kolla_start           43 minutes ago  Up 43 minutes ago         heat_api_cron
89faab28243f  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-heat-api-cfn:16.1-46        kolla_start           43 minutes ago  Up 43 minutes ago         heat_api_cfn
e53bc0910e80  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-heat-api:16.1-45            kolla_start           43 minutes ago  Up 43 minutes ago         heat_api
c433816767ac  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-cinder-scheduler:16.1-43    kolla_start           43 minutes ago  Up 43 minutes ago         cinder_scheduler
78c0b0f77a5b  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-cinder-api:16.1-43          kolla_start           43 minutes ago  Up 43 minutes ago         cinder_api_cron
bea3f6a2d3ac  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-cinder-api:16.1-43          kolla_start           43 minutes ago  Up 43 minutes ago         cinder_api
4d7bc9f52883  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-keystone:16.1-44            kolla_start           47 minutes ago  Up 47 minutes ago         keystone
a95eeda0af6e  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-iscsid:16.1-49              kolla_start           48 minutes ago  Up 47 minutes ago         iscsid
1fe38dc7fab2  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-ovn-northd:16.1-45          /bin/bash /usr/lo...  48 minutes ago  Up 48 minutes ago         ovn-dbs-bundle-podman-0
a118151e2e2c  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-horizon:16.1-46             kolla_start           49 minutes ago  Up 49 minutes ago         horizon
f4e967dd1670  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-haproxy:16.1-50             /bin/bash /usr/lo...  51 minutes ago  Up 51 minutes ago         haproxy-bundle-podman-0
aae647df29a2  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-redis:16.1-48               /bin/bash /usr/lo...  52 minutes ago  Up 52 minutes ago         redis-bundle-podman-0
73a5a625e635  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-mariadb:16.1-52             kolla_start           53 minutes ago  Up 53 minutes ago         clustercheck
7a5c60b907e0  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-rabbitmq:16.1-50            /bin/bash /usr/lo...  54 minutes ago  Up 54 minutes ago         rabbitmq-bundle-podman-0
5513b24c362f  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-mariadb:16.1-52             /bin/bash /usr/lo...  56 minutes ago  Up 56 minutes ago         galera-bundle-podman-0
a22ed2016c19  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-memcached:16.1-50           kolla_start           57 minutes ago  Up 57 minutes ago         memcached</pre></div></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="icon-note" title="Note"></i></td><td class="content">Notice the images are pulled from the undercloud node.</td></tr></table></div></li><li><p>Check the pacemaker cluster status:</p><div class="listingblock"><div class="title">[overcloud-controller-0]</div><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ sudo pcs status</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">Cluster name: tripleo_cluster
Stack: corosync
Current DC: overcloud-controller-1 (version 2.0.2-3.el8_1.2-744a30d655) - partition with quorum
Build Version: 1.6.7   :   Last updated: Wed Jun 10 13:05:09 2020
Last change: Wed Jun 10 11:58:53 2020 by root via cibadmin on overcloud-controller-0

15 nodes configured
47 resources configured

Online: [ overcloud-controller-0 overcloud-controller-1 overcloud-controller-2 ]
GuestOnline: [ galera-bundle-0@overcloud-controller-0 galera-bundle-1@overcloud-controller-1 galera-bundle-2@overcloud-controller-2 ovn-dbs-bundle-0@overcloud-controller-0 ovn-dbs-bundle-1@overcloud-controller-1 ovn-dbs-bundle-2@overcloud-controller-2 rabbitmq-bundle-0@overcloud-controller-0 rabbitmq-bundle-1@overcloud-controller-1 rabbitmq-bundle-2@overcloud-controller-2 redis-bundle-0@overcloud-controller-0 redis-bundle-1@overcloud-controller-1 redis-bundle-2@overcloud-controller-2 ]

Full list of resources:

 Container bundle set: galera-bundle [cluster.common.tag/openstack-mariadb:pcmklatest]
   galera-bundle-0	(ocf::heartbeat:galera):	Master overcloud-controller-0
   galera-bundle-1	(ocf::heartbeat:galera):	Master overcloud-controller-1
   galera-bundle-2	(ocf::heartbeat:galera):	Master overcloud-controller-2
 Container bundle set: rabbitmq-bundle [cluster.common.tag/openstack-rabbitmq:pcmklatest]
   rabbitmq-bundle-0	(ocf::heartbeat:rabbitmq-cluster):	Started overcloud-controller-0
   rabbitmq-bundle-1	(ocf::heartbeat:rabbitmq-cluster):	Started overcloud-controller-1
   rabbitmq-bundle-2	(ocf::heartbeat:rabbitmq-cluster):	Started overcloud-controller-2
 Container bundle set: redis-bundle [cluster.common.tag/openstack-redis:pcmklatest]
   redis-bundle-0	(ocf::heartbeat:redis):	Master overcloud-controller-0
   redis-bundle-1	(ocf::heartbeat:redis):	Slave overcloud-controller-1
   redis-bundle-2	(ocf::heartbeat:redis):	Slave overcloud-controller-2
 ip-192.0.2.11	(ocf::heartbeat:IPaddr2):	Started overcloud-controller-0
 ip-10.0.0.205	(ocf::heartbeat:IPaddr2):	Started overcloud-controller-1
 ip-172.17.0.206	(ocf::heartbeat:IPaddr2):	Started overcloud-controller-2
 ip-172.17.0.234	(ocf::heartbeat:IPaddr2):	Started overcloud-controller-0
 ip-172.18.0.78	(ocf::heartbeat:IPaddr2):	Started overcloud-controller-1
 ip-172.19.0.8	(ocf::heartbeat:IPaddr2):	Started overcloud-controller-2
 Container bundle set: haproxy-bundle [cluster.common.tag/openstack-haproxy:pcmklatest]
   haproxy-bundle-podman-0	(ocf::heartbeat:podman):	Started overcloud-controller-0
   haproxy-bundle-podman-1	(ocf::heartbeat:podman):	Started overcloud-controller-1
   haproxy-bundle-podman-2	(ocf::heartbeat:podman):	Started overcloud-controller-2
 Container bundle set: ovn-dbs-bundle [cluster.common.tag/openstack-ovn-northd:pcmklatest]
   ovn-dbs-bundle-0	(ocf::ovn:ovndb-servers):	Master overcloud-controller-0
   ovn-dbs-bundle-1	(ocf::ovn:ovndb-servers):	Slave overcloud-controller-1
   ovn-dbs-bundle-2	(ocf::ovn:ovndb-servers):	Slave overcloud-controller-2
 ip-172.17.0.244	(ocf::heartbeat:IPaddr2):	Started overcloud-controller-0
 Container bundle: openstack-cinder-volume [cluster.common.tag/openstack-cinder-volume:pcmklatest]
   openstack-cinder-volume-podman-0	(ocf::heartbeat:podman):	Started overcloud-controller-1

Daemon Status:
  corosync: active/enabled
  pacemaker: active/enabled
  pcsd: active/enabled</pre></div></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="icon-note" title="Note"></i></td><td class="content">Pacemaker manages the Virtual IPs, the HA services (galera, rabbitmq, redis), a failover service (cinder-volume) and the OVN database.</td></tr></table></div></li><li><p>Check the content of the <code>haproxy.cfg</code> configuration file inside the container:</p><div class="listingblock"><div class="title">[overcloud-controller-0]</div><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ sudo podman exec -ti haproxy-bundle-podman-0 cat /etc/haproxy/haproxy.cfg</pre></div></div>
<div class="listingblock"><div class="title">Sample Excerpt</div><div class="content"><pre class="nowrap">&lt;&lt;OMITTED&gt;&gt;
listen cinder
  bind 10.0.0.205:8776 transparent
  bind 172.17.0.234:8776 transparent
  mode http
  http-request set-header X-Forwarded-Proto https if { ssl_fc }
  http-request set-header X-Forwarded-Proto http if !{ ssl_fc }
  http-request set-header X-Forwarded-Port %[dst_port]
  option httpchk
  option httplog
  server overcloud-controller-0.internalapi.localdomain 172.17.0.132:8776 check fall 5 inter 2000 rise 2
  server overcloud-controller-1.internalapi.localdomain 172.17.0.134:8776 check fall 5 inter 2000 rise 2
  server overcloud-controller-2.internalapi.localdomain 172.17.0.236:8776 check fall 5 inter 2000 rise 2

listen glance_api
  bind 10.0.0.205:9292 transparent
  bind 172.17.0.234:9292 transparent
  mode http
  http-request set-header X-Forwarded-Proto https if { ssl_fc }
  http-request set-header X-Forwarded-Proto http if !{ ssl_fc }
  http-request set-header X-Forwarded-Port %[dst_port]
  option httpchk GET /healthcheck
  server overcloud-controller-0.internalapi.localdomain 172.17.0.132:9292 check fall 5 inter 2000 rise 2
  server overcloud-controller-1.internalapi.localdomain 172.17.0.134:9292 check fall 5 inter 2000 rise 2
  server overcloud-controller-2.internalapi.localdomain 172.17.0.236:9292 check fall 5 inter 2000 rise 2

&lt;&lt;OMITTED&gt;&gt;</pre></div></div></li></ol></div></div>
<div class="sect2"><h3 id="_compute">1.2. Compute</h3><div class="olist arabic"><ol class="arabic"><li><p>Login to a compute node from the undercloud:</p><div class="listingblock"><div class="title">[undercloud]</div><div class="content"><pre class="nowrap">(overcloud) [stack@undercloud ~]$ ssh heat-admin@overcloud-novacompute-0.ctlplane</pre></div></div></li><li><p>List containers running on a compute node:</p><div class="listingblock"><div class="title">[Compute node]</div><div class="content"><pre class="nowrap">[heat-admin@overcloud-novacompute-0 ~]$ sudo podman ps</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">CONTAINER ID  IMAGE                                                                                          COMMAND      CREATED         STATUS             PORTS  NAMES
3b9fab73c0f4  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-nova-compute:16.1-43                kolla_start  41 minutes ago  Up 41 minutes ago         nova_compute
349247b1e3a3  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-neutron-metadata-agent-ovn:16.1-46  kolla_start  44 minutes ago  Up 44 minutes ago         ovn_metadata_agent
dcd6c1a6a4e2  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-ovn-controller:16.1-46              kolla_start  44 minutes ago  Up 44 minutes ago         ovn_controller
4da8eca430ba  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-nova-compute:16.1-43                kolla_start  44 minutes ago  Up 44 minutes ago         nova_migration_target
c4cb6fa71bdc  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-cron:16.1-50                        kolla_start  44 minutes ago  Up 44 minutes ago         logrotate_crond
fbc4116f7c46  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-iscsid:16.1-49                      kolla_start  50 minutes ago  Up 50 minutes ago         iscsid
65019301af07  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-nova-libvirt:16.1-46                kolla_start  50 minutes ago  Up 50 minutes ago         nova_libvirt
da58a8e1eeb9  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-nova-libvirt:16.1-46                kolla_start  50 minutes ago  Up 50 minutes ago         nova_virtlogd</pre></div></div></li><li><p>List process inside one container:</p><div class="listingblock"><div class="title">[Compute node]</div><div class="content"><pre class="nowrap">[heat-admin@overcloud-novacompute-0 ~]$ sudo podman exec -ti nova_compute ps auxww</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
nova           1  0.0  0.0   4204   704 ?        Ss   11:58   0:00 dumb-init --single-child -- kolla_start
nova           7  0.3  2.0 2190956 161804 ?      Sl   11:58   0:13 /usr/bin/python3 /usr/bin/nova-compute
nova         941  0.0  0.0  46884  3708 pts/1    Rs+  13:11   0:00 ps auxww</pre></div></div></li></ol></div></div></div></div>
<div class="sect1"><h2 id="_post_deployment_tasks">2. Post Deployment Tasks</h2><div class="sectionbody"><div class="paragraph"><p>Despite building out an overcloud with OSP director, it&#8217;s not ready for any workloads; it doesn&#8217;t have any <strong>images</strong>, <strong>networks</strong>, nor <strong>keypairs</strong> for us to use. In order to test whether our deployment has been a success, we should create these now.</p></div>
<div class="listingblock"><div class="title">[undercloud]</div><div class="content"><pre class="nowrap">(undercloud) [stack@undercloud ~]$ ssh heat-admin@overcloud-controller-0.ctlplane</pre></div></div>
<div class="paragraph"><p>The first task is to create a network in Neutron. Out of the box, the default Heat stack templates force <code>nic1</code>, or <code>eth0</code>, in our case to be bridged to an Open vSwitch bridge named <code>br-ex</code>. Unfortunately, this would mean that external routing from our instances would go onto the <code>provisioning</code>, and not to a separate network for public access that we would prefer. We can confirm this by running the following:</p></div>
<div class="listingblock"><div class="title">[overcloud-controller]</div><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ sudo ovs-vsctl show | grep -A10 'Bridge br-ex'</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">8891ad99-8120-477e-abe8-9b2090c7f120
    Bridge br-ex
        fail_mode: standalone
        Port "vlan50"
            tag: 50
            Interface "vlan50"
                type: internal
        Port "vlan10"
            tag: 10
            Interface "vlan10"
                type: internal
        Port "vlan40"
            tag: 40
            Interface "vlan40"
                type: internal
        Port "vlan30"
            tag: 30
            Interface "vlan30"
                type: internal
        Port "vlan20"
            tag: 20
            Interface "vlan20"
                type: internal
        Port "bond1"
            Interface "ens4"
            Interface "ens5"
        Port br-ex
            Interface br-ex
                type: internal
    Bridge br-int
        fail_mode: secure
        Port "ovn-1601a0-0"
            Interface "ovn-1601a0-0"
                type: geneve
                options: {csum="true", key=flow, remote_ip="172.16.0.216"}
        Port "ovn-b393a8-0"
            Interface "ovn-b393a8-0"
                type: geneve
                options: {csum="true", key=flow, remote_ip="172.16.0.17"}
        Port "ovn-78654e-0"
            Interface "ovn-78654e-0"
                type: geneve
                options: {csum="true", key=flow, remote_ip="172.16.0.180"}
        Port "ovn-85688d-0"
            Interface "ovn-85688d-0"
                type: geneve
                options: {csum="true", key=flow, remote_ip="172.16.0.222"}
        Port br-int
            Interface br-int
                type: internal
    ovs_version: "2.11.0"</pre></div></div>
<div class="paragraph"><p>Review the IP configuration</p></div>
<div class="listingblock"><div class="title">[overcloud-controller]</div><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ ip --brief address show</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">lo               UNKNOWN        127.0.0.1/8 ::1/128
ens3             UP             192.0.2.10/24 192.0.2.11/32 fe80::5054:ff:fe5a:c166/64
ens4             UP             fe80::5054:ff:fe68:90ef/64
ens5             UP             fe80::5054:ff:feb3:9344/64
ens6             UP             fe80::5054:ff:fe56:17b9/64
ovs-system       DOWN
br-ex            UNKNOWN        fe80::687b:7dff:fe3b:a046/64
vlan40           UNKNOWN        172.19.0.239/24 fe80::e8eb:39ff:fe52:fdb9/64
vlan10           UNKNOWN        10.0.0.131/24 fe80::78c4:5ff:feba:770/64
vlan50           UNKNOWN        172.16.0.40/24 fe80::54f5:e9ff:fe1a:ace6/64
vlan20           UNKNOWN        172.17.0.132/24 172.17.0.234/32 172.17.0.244/32 fe80::907e:4cff:fec3:e940/64
vlan30           UNKNOWN        172.18.0.209/24 fe80::7046:3bff:fe08:8413/64
br-int           DOWN
genev_sys_6081   UNKNOWN        fe80::70ab:30ff:fee8:dfc0/64</pre></div></div>
<div class="paragraph"><p>This networking configuration is setup by <code>os-net-config</code> at deployment time after being called by <code>os-refresh-config</code>. The configuration for this is set via the <code>OS::TripleO::Controller::Net::SoftwareConfig</code>
resource, and provided to the node via Heat&#8217;s metadata service. We can see how this looks on the overcloud node:</p></div>
<div class="listingblock"><div class="title">[overcloud-controller]</div><div class="content"><pre class="nowrap">(overcloud) [heat-admin@overcloud-controller-0 ~]$ jq "." /etc/os-net-config/config.json</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">{
  "network_config": [
    {
      "addresses": [
        {
          "ip_netmask": "192.0.2.10/24"
        }
      ],
      "mtu": 1500,
      "name": "nic1",
      "routes": [],
      "type": "interface",
      "use_dhcp": false
    },
    {
      "dns_servers": [
        "192.0.2.254"
      ],
      "domain": [],
      "members": [
        {
          "members": [
            {
              "mtu": 1500,
              "name": "nic2",
              "primary": true,
              "type": "interface"
            },
            {
              "mtu": 1500,
              "name": "nic3",
              "type": "interface"
            }
          ],
          "mtu": 1500,
          "name": "bond1",
          "ovs_options": "bond_mode=active-backup",
          "type": "ovs_bond"
        },
        {
          "addresses": [
            {
              "ip_netmask": "172.18.0.209/24"
            }
          ],
          "mtu": 1500,
          "routes": [],
          "type": "vlan",
          "vlan_id": 30
        },
        {
          "addresses": [
            {
              "ip_netmask": "172.19.0.239/24"
            }
          ],
          "mtu": 1500,
          "routes": [],
          "type": "vlan",
          "vlan_id": 40
        },
        {
          "addresses": [
            {
              "ip_netmask": "172.17.0.132/24"
            }
          ],
          "mtu": 1500,
          "routes": [],
          "type": "vlan",
          "vlan_id": 20
        },
        {
          "addresses": [
            {
              "ip_netmask": "172.16.0.40/24"
            }
          ],
          "mtu": 1500,
          "routes": [],
          "type": "vlan",
          "vlan_id": 50
        },
        {
          "addresses": [
            {
              "ip_netmask": "10.0.0.131/24"
            }
          ],
          "mtu": 1500,
          "routes": [
            {
              "default": true,
              "next_hop": "10.0.0.1"
            }
          ],
          "type": "vlan",
          "vlan_id": 10
        }
      ],
      "name": "br-ex",
      "type": "ovs_bridge"
    }
  ]
}
</pre></div></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="icon-note" title="Note"></i></td><td class="content">The <code>os-net-config</code> utility uses <code>nic1</code> to identify the first network card, in our case <code>eth0</code>. Not to be confused with <code>net0</code>, the iPXE designation.</td></tr></table></div>
<div class="paragraph"><p>This is fine for our basic deployment and we&#8217;ll be able to test networking functionality, but in the advanced labs we&#8217;ll ensure that the bridge is set up on the public network instead.</p></div>
<div class="paragraph"><p>From undercloud, let&#8217;s create an external network for us to use, in reality this will be a network that we can connect to via floating IP addresses on the <code>management</code> network.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Create public network</p><div class="listingblock"><div class="content"><pre class="nowrap">(overcloud) [stack@undercloud ~]$ openstack network create public \
  --external --provider-physical-network datacentre \
  --provider-network-type vlan --provider-segment 10</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">+---------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Field                     | Value                                                                                                                                                            |
+---------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| admin_state_up            | UP                                                                                                                                                               |
| availability_zone_hints   |                                                                                                                                                                  |
| availability_zones        |                                                                                                                                                                  |
| created_at                | 2020-06-10T13:32:21Z                                                                                                                                             |
| description               |                                                                                                                                                                  |
| dns_domain                |                                                                                                                                                                  |
| id                        | 3f52c905-ee47-4786-b717-868e842fe273                                                                                                                             |
| ipv4_address_scope        | None                                                                                                                                                             |
| ipv6_address_scope        | None                                                                                                                                                             |
| is_default                | False                                                                                                                                                            |
| is_vlan_transparent       | None                                                                                                                                                             |
| location                  | cloud='', project.domain_id=, project.domain_name='Default', project.id='1206c1b5fe644711ad8103f90d312d76', project.name='admin', region_name='regionOne', zone= |
| mtu                       | 1500                                                                                                                                                             |
| name                      | public                                                                                                                                                           |
| port_security_enabled     | True                                                                                                                                                             |
| project_id                | 1206c1b5fe644711ad8103f90d312d76                                                                                                                                 |
| provider:network_type     | vlan                                                                                                                                                             |
| provider:physical_network | datacentre                                                                                                                                                       |
| provider:segmentation_id  | 10                                                                                                                                                               |
| qos_policy_id             | None                                                                                                                                                             |
| revision_number           | 1                                                                                                                                                                |
| router:external           | External                                                                                                                                                         |
| segments                  | None                                                                                                                                                             |
| shared                    | False                                                                                                                                                            |
| status                    | ACTIVE                                                                                                                                                           |
| subnets                   |                                                                                                                                                                  |
| tags                      |                                                                                                                                                                  |
| updated_at                | 2020-06-10T13:32:21Z                                                                                                                                             |
+---------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+</pre></div></div></li><li><p>Create a subnet on the <code>public</code> network using this command to match the subnet parameters to the actual subnet range and gateway IP address in the lab environment:</p><div class="listingblock"><div class="content"><pre class="nowrap">(overcloud) [stack@undercloud ~]$ openstack subnet create public-subnet \
  --no-dhcp --network public --subnet-range 10.0.0.0/24 \
  --allocation-pool start=10.0.0.100,end=10.0.0.200  \
  --gateway 10.0.0.1 --dns-nameserver 8.8.8.8</pre></div></div></li></ol></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">+-------------------+--------------------------------------+
+-------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Field             | Value                                                                                                                                                            |
+-------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| allocation_pools  | 10.0.0.100-10.0.0.200                                                                                                                                            |
| cidr              | 10.0.0.0/24                                                                                                                                                      |
| created_at        | 2020-06-10T13:33:52Z                                                                                                                                             |
| description       |                                                                                                                                                                  |
| dns_nameservers   | 8.8.8.8                                                                                                                                                          |
| enable_dhcp       | False                                                                                                                                                            |
| gateway_ip        | 10.0.0.1                                                                                                                                                         |
| host_routes       |                                                                                                                                                                  |
| id                | d8e19b16-780e-4cc7-9439-f007214a8824                                                                                                                             |
| ip_version        | 4                                                                                                                                                                |
| ipv6_address_mode | None                                                                                                                                                             |
| ipv6_ra_mode      | None                                                                                                                                                             |
| location          | cloud='', project.domain_id=, project.domain_name='Default', project.id='1206c1b5fe644711ad8103f90d312d76', project.name='admin', region_name='regionOne', zone= |
| name              | public-subnet                                                                                                                                                    |
| network_id        | 3f52c905-ee47-4786-b717-868e842fe273                                                                                                                             |
| prefix_length     | None                                                                                                                                                             |
| project_id        | 1206c1b5fe644711ad8103f90d312d76                                                                                                                                 |
| revision_number   | 0                                                                                                                                                                |
| segment_id        | None                                                                                                                                                             |
| service_types     |                                                                                                                                                                  |
| subnetpool_id     | None                                                                                                                                                             |
| tags              |                                                                                                                                                                  |
| updated_at        | 2020-06-10T13:33:52Z                                                                                                                                             |
+-------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+</pre></div></div></div></div>
<div class="sect1"><h2 id="_create_tenant_network">3. Create Tenant Network</h2><div class="sectionbody"><div class="olist arabic"><ol class="arabic"><li><p>Create a tenant network named <code>private</code>:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ openstack network create private</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">+---------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Field                     | Value                                                                                                                                                            |
+---------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| admin_state_up            | UP                                                                                                                                                               |
| availability_zone_hints   |                                                                                                                                                                  |
| availability_zones        |                                                                                                                                                                  |
| created_at                | 2020-06-10T13:39:58Z                                                                                                                                             |
| description               |                                                                                                                                                                  |
| dns_domain                |                                                                                                                                                                  |
| id                        | c854a369-5169-4765-98d6-8965bb86974f                                                                                                                             |
| ipv4_address_scope        | None                                                                                                                                                             |
| ipv6_address_scope        | None                                                                                                                                                             |
| is_default                | False                                                                                                                                                            |
| is_vlan_transparent       | None                                                                                                                                                             |
| location                  | cloud='', project.domain_id=, project.domain_name='Default', project.id='1206c1b5fe644711ad8103f90d312d76', project.name='admin', region_name='regionOne', zone= |
| mtu                       | 1442                                                                                                                                                             |
| name                      | private                                                                                                                                                          |
| port_security_enabled     | True                                                                                                                                                             |
| project_id                | 1206c1b5fe644711ad8103f90d312d76                                                                                                                                 |
| provider:network_type     | geneve                                                                                                                                                           |
| provider:physical_network | None                                                                                                                                                             |
| provider:segmentation_id  | 10                                                                                                                                                               |
| qos_policy_id             | None                                                                                                                                                             |
| revision_number           | 1                                                                                                                                                                |
| router:external           | Internal                                                                                                                                                         |
| segments                  | None                                                                                                                                                             |
| shared                    | False                                                                                                                                                            |
| status                    | ACTIVE                                                                                                                                                           |
| subnets                   |                                                                                                                                                                  |
| tags                      |                                                                                                                                                                  |
| updated_at                | 2020-06-10T13:39:58Z                                                                                                                                             |
+---------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+</code></pre></div></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="icon-note" title="Note"></i></td><td class="content">Notice the <code>network_type</code> is <code>geneve</code> due we are using OVN. That information is hidden when a regular user is creating a network.</td></tr></table></div></li><li><p>Create a subnet for the newly created <code>private</code> network:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ openstack subnet create private-subnet \
  --network private \
  --dns-nameserver 8.8.4.4 --gateway 172.16.1.1 \
  --subnet-range 172.16.1.0/24</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">+-------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Field             | Value                                                                                                                                                            |
+-------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| allocation_pools  | 172.16.1.2-172.16.1.254                                                                                                                                          |
| cidr              | 172.16.1.0/24                                                                                                                                                    |
| created_at        | 2020-06-10T13:42:15Z                                                                                                                                             |
| description       |                                                                                                                                                                  |
| dns_nameservers   | 8.8.4.4                                                                                                                                                          |
| enable_dhcp       | True                                                                                                                                                             |
| gateway_ip        | 172.16.1.1                                                                                                                                                       |
| host_routes       |                                                                                                                                                                  |
| id                | 1a1a48f8-3cf3-4c0e-8cf7-eb18b1c36330                                                                                                                             |
| ip_version        | 4                                                                                                                                                                |
| ipv6_address_mode | None                                                                                                                                                             |
| ipv6_ra_mode      | None                                                                                                                                                             |
| location          | cloud='', project.domain_id=, project.domain_name='Default', project.id='1206c1b5fe644711ad8103f90d312d76', project.name='admin', region_name='regionOne', zone= |
| name              | private-subnet                                                                                                                                                   |
| network_id        | c854a369-5169-4765-98d6-8965bb86974f                                                                                                                             |
| prefix_length     | None                                                                                                                                                             |
| project_id        | 1206c1b5fe644711ad8103f90d312d76                                                                                                                                 |
| revision_number   | 0                                                                                                                                                                |
| segment_id        | None                                                                                                                                                             |
| service_types     |                                                                                                                                                                  |
| subnetpool_id     | None                                                                                                                                                             |
| tags              |                                                                                                                                                                  |
| updated_at        | 2020-06-10T13:42:15Z                                                                                                                                             |
+-------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+</code></pre></div></div></li><li><p>Create a virtual router:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ openstack router create router1</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">+-------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Field                   | Value                                                                                                                                                            |
+-------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| admin_state_up          | UP                                                                                                                                                               |
| availability_zone_hints | None                                                                                                                                                             |
| availability_zones      | None                                                                                                                                                             |
| created_at              | 2020-06-10T13:43:50Z                                                                                                                                             |
| description             |                                                                                                                                                                  |
| external_gateway_info   | null                                                                                                                                                             |
| flavor_id               | None                                                                                                                                                             |
| id                      | 81e92740-4449-4d6c-b504-76a10c39c703                                                                                                                             |
| location                | cloud='', project.domain_id=, project.domain_name='Default', project.id='1206c1b5fe644711ad8103f90d312d76', project.name='admin', region_name='regionOne', zone= |
| name                    | router1                                                                                                                                                          |
| project_id              | 1206c1b5fe644711ad8103f90d312d76                                                                                                                                 |
| revision_number         | 0                                                                                                                                                                |
| routes                  |                                                                                                                                                                  |
| status                  | ACTIVE                                                                                                                                                           |
| tags                    |                                                                                                                                                                  |
| updated_at              | 2020-06-10T13:43:50Z                                                                                                                                             |
+-------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+</code></pre></div></div></li><li><p>Add <code>private-subnet</code> to the router:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ openstack router add subnet router1 private-subnet</code></pre></div></div></li><li><p>Set <code>router1</code> as a gateway to the <code>public</code> network:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ openstack router set router1 --external-gateway public</code></pre></div></div></li><li><p>Verify that the router has fixed IP addresses on <code>public-subnet</code> and <code>private-subnet</code>:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ openstack port list --router=router1</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">+--------------------------------------+------+-------------------+---------------------------------------------------------------------------+--------+
| ID                                   | Name | MAC Address       | Fixed IP Addresses                                                        | Status |
+--------------------------------------+------+-------------------+---------------------------------------------------------------------------+--------+
| 04a242ae-46bc-4df3-8653-3ef09cae1956 |      | fa:16:3e:04:bb:00 | ip_address='10.0.0.190', subnet_id='d8e19b16-780e-4cc7-9439-f007214a8824' | ACTIVE |
| fa0d8d2a-b196-42fa-9537-766481b1d081 |      | fa:16:3e:b8:eb:cd | ip_address='172.16.1.1', subnet_id='1a1a48f8-3cf3-4c0e-8cf7-eb18b1c36330' | ACTIVE |
+--------------------------------------+------+-------------------+---------------------------------------------------------------------------+--------+</code></pre></div></div></li><li><p>Verify that you can ping the router&#8217;s IP address on <code>public-subnet</code>:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ ping -c3 10.0.0.190</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">PING 10.0.0.190 (10.0.0.190) 56(84) bytes of data.
64 bytes from 10.0.0.190: icmp_seq=1 ttl=253 time=0.842 ms
64 bytes from 10.0.0.190: icmp_seq=2 ttl=253 time=0.715 ms
64 bytes from 10.0.0.190: icmp_seq=3 ttl=253 time=0.773 ms

--- 10.0.0.190 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 53ms
rtt min/avg/max/mdev = 0.715/0.776/0.842/0.061 ms</code></pre></div></div>
<div class="admonitionblock important"><table><tr><td class="icon"><i class="icon-important" title="Important"></i></td><td class="content">Use the IP address allocated to the router in your environment.</td></tr></table></div></li></ol></div></div></div>
<div class="sect1"><h2 id="_create_flavor_modify_security_group_and_upload_image">4. Create Flavor, Modify Security Group, and Upload Image</h2><div class="sectionbody"><div class="sect2"><h3 id="_create_flavor_in_overcloud">4.1. Create Flavor in Overcloud</h3><div class="olist arabic"><ol class="arabic"><li><p>Create a custom flavor with one vCPU and 64 MB of memory:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ openstack flavor create m1.nano --vcpus 1 --ram 64 --disk 1</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">+----------------------------+--------------------------------------+
| Field                      | Value                                |
+----------------------------+--------------------------------------+
| OS-FLV-DISABLED:disabled   | False                                |
| OS-FLV-EXT-DATA:ephemeral  | 0                                    |
| disk                       | 1                                    |
| id                         | 03653d06-d01c-431c-8a0a-bd16d1b89acf |
| name                       | m1.nano                              |
| os-flavor-access:is_public | True                                 |
| properties                 |                                      |
| ram                        | 64                                   |
| rxtx_factor                | 1.0                                  |
| swap                       |                                      |
| vcpus                      | 1                                    |
+----------------------------+--------------------------------------+</code></pre></div></div></li></ol></div></div>
<div class="sect2"><h3 id="_modify_default_security_group">4.2. Modify Default Security Group</h3><div class="paragraph"><p>Each project has its own default security group.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Confirm the presence of the default security group:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ openstack security group list --project admin</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">+--------------------------------------+---------+------------------------+----------------------------------+------+
| ID                                   | Name    | Description            | Project                          | Tags |
+--------------------------------------+---------+------------------------+----------------------------------+------+
| c39b34d9-9cd0-4192-8b70-c0e3b17cab25 | default | Default security group | 1206c1b5fe644711ad8103f90d312d76 | []   |
+--------------------------------------+---------+------------------------+----------------------------------+------+</code></pre></div></div>
<div class="ulist"><ul><li><p>If you run this command as the <code>admin</code> user you can see multiple <code>default</code> security groups belonging to different projects.</p></li></ul></div></li><li><p>Create a rule allowing you to ping cloud instances:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ SGID=$(openstack security group list --project admin -c ID -f value)
(overcloud) [stack@undercloud ~]$ openstack security group rule create --proto icmp $SGID</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">+-------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Field             | Value                                                                                                                                                            |
+-------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| created_at        | 2020-06-10T13:54:49Z                                                                                                                                             |
| description       |                                                                                                                                                                  |
| direction         | ingress                                                                                                                                                          |
| ether_type        | IPv4                                                                                                                                                             |
| id                | e30a8d6a-7999-4460-9ec7-0329b4c5184d                                                                                                                             |
| location          | cloud='', project.domain_id=, project.domain_name='Default', project.id='1206c1b5fe644711ad8103f90d312d76', project.name='admin', region_name='regionOne', zone= |
| name              | None                                                                                                                                                             |
| port_range_max    | None                                                                                                                                                             |
| port_range_min    | None                                                                                                                                                             |
| project_id        | 1206c1b5fe644711ad8103f90d312d76                                                                                                                                 |
| protocol          | icmp                                                                                                                                                             |
| remote_group_id   | None                                                                                                                                                             |
| remote_ip_prefix  | 0.0.0.0/0                                                                                                                                                        |
| revision_number   | 0                                                                                                                                                                |
| security_group_id | c39b34d9-9cd0-4192-8b70-c0e3b17cab25                                                                                                                             |
| tags              | []                                                                                                                                                               |
| updated_at        | 2020-06-10T13:54:49Z                                                                                                                                             |
+-------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+</code></pre></div></div></li><li><p>Create a rule allowing SSH access to cloud instances:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ openstack security group rule create --dst-port 22 --proto tcp $SGID</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">+-------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Field             | Value                                                                                                                                                            |
+-------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| created_at        | 2020-06-10T13:55:17Z                                                                                                                                             |
| description       |                                                                                                                                                                  |
| direction         | ingress                                                                                                                                                          |
| ether_type        | IPv4                                                                                                                                                             |
| id                | a1bcf527-0d3c-412e-b8af-31db8e2b3781                                                                                                                             |
| location          | cloud='', project.domain_id=, project.domain_name='Default', project.id='1206c1b5fe644711ad8103f90d312d76', project.name='admin', region_name='regionOne', zone= |
| name              | None                                                                                                                                                             |
| port_range_max    | 22                                                                                                                                                               |
| port_range_min    | 22                                                                                                                                                               |
| project_id        | 1206c1b5fe644711ad8103f90d312d76                                                                                                                                 |
| protocol          | tcp                                                                                                                                                              |
| remote_group_id   | None                                                                                                                                                             |
| remote_ip_prefix  | 0.0.0.0/0                                                                                                                                                        |
| revision_number   | 0                                                                                                                                                                |
| security_group_id | c39b34d9-9cd0-4192-8b70-c0e3b17cab25                                                                                                                             |
| tags              | []                                                                                                                                                               |
| updated_at        | 2020-06-10T13:55:17Z                                                                                                                                             |
+-------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+</code></pre></div></div></li></ol></div></div>
<div class="sect2"><h3 id="_upload_image">4.3. Upload Image</h3><div class="olist arabic"><ol class="arabic"><li><p>Download the <code>cirros</code> image:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ curl -L -O http://download.cirros-cloud.net/0.4.0/cirros-0.4.0-x86_64-disk.img</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                               Dload  Upload   Total   Spent    Left  Speed
100 12.1M  100 12.1M    0     0  5714k      0  0:00:02  0:00:02 --:--:-- 5717k</code></pre></div></div></li><li><p>Upload the <code>cirros</code> image file to the overcloud Glance repository:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ openstack image create cirros   --file cirros-0.4.0-x86_64-disk.img   --disk-format qcow2 --container-format bare</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Field            | Value                                                                                                                                                                                                                                                                                                 |
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| checksum         | 443b7623e27ecf03dc9e01ee93f67afe                                                                                                                                                                                                                                                                      |
| container_format | bare                                                                                                                                                                                                                                                                                                  |
| created_at       | 2020-06-10T15:10:41Z                                                                                                                                                                                                                                                                                  |
| disk_format      | qcow2                                                                                                                                                                                                                                                                                                 |
| file             | /v2/images/4b3fed2b-2c5f-4a6f-8046-74718d40de6e/file                                                                                                                                                                                                                                                  |
| id               | 4b3fed2b-2c5f-4a6f-8046-74718d40de6e                                                                                                                                                                                                                                                                  |
| min_disk         | 0                                                                                                                                                                                                                                                                                                     |
| min_ram          | 0                                                                                                                                                                                                                                                                                                     |
| name             | cirros                                                                                                                                                                                                                                                                                                |
| owner            | 1206c1b5fe644711ad8103f90d312d76                                                                                                                                                                                                                                                                      |
| properties       | direct_url='file:///var/lib/glance/images/4b3fed2b-2c5f-4a6f-8046-74718d40de6e', os_hash_algo='sha512', os_hash_value='6513f21e44aa3da349f248188a44bc304a3653a04122d8fb4535423c8e1d14cd6a153f735bb0982e2161b5b5186106570c17a9e58b64dd39390617cd5a350f78', os_hidden='False', stores='default_backend' |
| protected        | False                                                                                                                                                                                                                                                                                                 |
| schema           | /v2/schemas/image                                                                                                                                                                                                                                                                                     |
| size             | 12716032                                                                                                                                                                                                                                                                                              |
| status           | active                                                                                                                                                                                                                                                                                                |
| tags             |                                                                                                                                                                                                                                                                                                       |
| updated_at       | 2020-06-10T15:10:41Z                                                                                                                                                                                                                                                                                  |
| virtual_size     | None                                                                                                                                                                                                                                                                                                  |
| visibility       | shared                                                                                                                                                                                                                                                                                                |
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</code></pre></div></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="icon-note" title="Note"></i></td><td class="content">Notice image is stored on <code>/var/lib/glance/images</code>. That is a mount point from the NFS server.</td></tr></table></div></li></ol></div></div></div></div>
<div class="sect1"><h2 id="_launch_test_instance_and_verify_access">5. Launch Test Instance and Verify Access</h2><div class="sectionbody"><div class="sect2"><h3 id="_launch_instance">5.1. Launch Instance</h3><div class="olist arabic"><ol class="arabic"><li><p>Create an instance called <code>test-instance</code> using the flavor, image, network, and security group that you defined earlier:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ openstack server create test-instance --network private --flavor m1.nano --image cirros</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">+-------------------------------------+-----------------------------------------------------------------------------------+
| Field                               | Value                                                                             |
+-------------------------------------+-----------------------------------------------------------------------------------+
| OS-DCF:diskConfig                   | MANUAL                                                                            |
| OS-EXT-AZ:availability_zone         |                                                                                   |
| OS-EXT-SRV-ATTR:host                | None                                                                              |
| OS-EXT-SRV-ATTR:hostname            | test-instance                                                                     |
| OS-EXT-SRV-ATTR:hypervisor_hostname | None                                                                              |
| OS-EXT-SRV-ATTR:instance_name       |                                                                                   |
| OS-EXT-SRV-ATTR:kernel_id           |                                                                                   |
| OS-EXT-SRV-ATTR:launch_index        | 0                                                                                 |
| OS-EXT-SRV-ATTR:ramdisk_id          |                                                                                   |
| OS-EXT-SRV-ATTR:reservation_id      | r-jozioq00                                                                        |
| OS-EXT-SRV-ATTR:root_device_name    | None                                                                              |
| OS-EXT-SRV-ATTR:user_data           | None                                                                              |
| OS-EXT-STS:power_state              | NOSTATE                                                                           |
| OS-EXT-STS:task_state               | scheduling                                                                        |
| OS-EXT-STS:vm_state                 | building                                                                          |
| OS-SRV-USG:launched_at              | None                                                                              |
| OS-SRV-USG:terminated_at            | None                                                                              |
| accessIPv4                          |                                                                                   |
| accessIPv6                          |                                                                                   |
| addresses                           |                                                                                   |
| adminPass                           | A8ve5GRpAj6d                                                                      |
| config_drive                        |                                                                                   |
| created                             | 2020-06-10T15:12:56Z                                                              |
| description                         | None                                                                              |
| flavor                              | disk='1', ephemeral='0', , original_name='m1.nano', ram='64', swap='0', vcpus='1' |
| hostId                              |                                                                                   |
| host_status                         |                                                                                   |
| id                                  | ff254845-c0c4-42cd-8ae8-1c5d0ff84a12                                              |
| image                               | cirros (4b3fed2b-2c5f-4a6f-8046-74718d40de6e)                                     |
| key_name                            | None                                                                              |
| locked                              | False                                                                             |
| locked_reason                       | None                                                                              |
| name                                | test-instance                                                                     |
| progress                            | 0                                                                                 |
| project_id                          | 1206c1b5fe644711ad8103f90d312d76                                                  |
| properties                          |                                                                                   |
| security_groups                     | name='default'                                                                    |
| server_groups                       | []                                                                                |
| status                              | BUILD                                                                             |
| tags                                | []                                                                                |
| trusted_image_certificates          | None                                                                              |
| updated                             | 2020-06-10T15:12:56Z                                                              |
| user_id                             | 3cf6f50c570547ef965e52fc85b1e464                                                  |
| volumes_attached                    |                                                                                   |
+-------------------------------------+-----------------------------------------------------------------------------------+</code></pre></div></div></li><li><p>Verify the status of <code>test-instance</code>:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ openstack server list</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">+--------------------------------------+---------------+--------+----------------------+--------+--------+
| ID                                   | Name          | Status | Networks             | Image  | Flavor |
+--------------------------------------+---------------+--------+----------------------+--------+--------+
| ff254845-c0c4-42cd-8ae8-1c5d0ff84a12 | test-instance | ACTIVE | private=172.16.1.162 | cirros |        |
+--------------------------------------+---------------+--------+----------------------+--------+--------+
</code></pre></div></div>
<div class="ulist"><ul><li><p>Wait until the instance is in the <code>ACTIVE</code> state.</p></li></ul></div></li><li><p>When the instance becomes <code>ACTIVE</code>, print the console log of the instance:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(user1) [stack@undercloud ~]$ openstack console log show test-instance</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">...
=== cirros: current=0.4.0 uptime=8.98 ===
  ____               ____  ____
 / __/ __ ____ ____ / __ \/ __/
/ /__ / // __// __// /_/ /\ \
\___//_//_/  /_/   \____/___/
   http://cirros-cloud.net


login as 'cirros' user. default password: 'gocubsgo'. use 'sudo' for root.
/dev/root resized successfully [took 0.42s]
test-instance login:</code></pre></div></div>
<div class="ulist"><ul><li><p>Note that the password for the <code>cirros</code> user is <code>gocubsgo</code>.</p></li></ul></div></li></ol></div></div>
<div class="sect2"><h3 id="_assign_floating_ip_address_to_test_instance">5.2. Assign Floating IP Address to Test Instance</h3><div class="olist arabic"><ol class="arabic"><li><p>Create a floating IP address from the floating IP allocation pool defined for the <code>public</code> network:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ openstack floating ip create public</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">+---------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Field               | Value                                                                                                                                                                                      |
+---------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| created_at          | 2020-06-10T15:14:06Z                                                                                                                                                                       |
| description         |                                                                                                                                                                                            |
| dns_domain          |                                                                                                                                                                                            |
| dns_name            |                                                                                                                                                                                            |
| fixed_ip_address    | None                                                                                                                                                                                       |
| floating_ip_address | 10.0.0.117                                                                                                                                                                                 |
| floating_network_id | 3f52c905-ee47-4786-b717-868e842fe273                                                                                                                                                       |
| id                  | 7ab089a0-74d1-4c14-9579-4ed2ac20fbaf                                                                                                                                                       |
| location            | Munch({'cloud': '', 'region_name': 'regionOne', 'zone': None, 'project': Munch({'id': '1206c1b5fe644711ad8103f90d312d76', 'name': 'admin', 'domain_id': None, 'domain_name': 'Default'})}) |
| name                | 10.0.0.117                                                                                                                                                                                 |
| port_details        | None                                                                                                                                                                                       |
| port_id             | None                                                                                                                                                                                       |
| project_id          | 1206c1b5fe644711ad8103f90d312d76                                                                                                                                                           |
| qos_policy_id       | None                                                                                                                                                                                       |
| revision_number     | 0                                                                                                                                                                                          |
| router_id           | None                                                                                                                                                                                       |
| status              | DOWN                                                                                                                                                                                       |
| subnet_id           | None                                                                                                                                                                                       |
| tags                | []                                                                                                                                                                                         |
| updated_at          | 2020-06-10T15:14:06Z                                                                                                                                                                       |
+---------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</code></pre></div></div></li><li><p>List the floating IP addresses:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ openstack floating ip list</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">+--------------------------------------+---------------------+------------------+------+--------------------------------------+----------------------------------+
| ID                                   | Floating IP Address | Fixed IP Address | Port | Floating Network                     | Project                          |
+--------------------------------------+---------------------+------------------+------+--------------------------------------+----------------------------------+
| 7ab089a0-74d1-4c14-9579-4ed2ac20fbaf | 10.0.0.117          | None             | None | 3f52c905-ee47-4786-b717-868e842fe273 | 1206c1b5fe644711ad8103f90d312d76 |
+--------------------------------------+---------------------+------------------+------+--------------------------------------+----------------------------------+</code></pre></div></div></li><li><p>Assign the floating IP address that you just created to the test instance:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ FIP=$(openstack floating ip list -c "Floating IP Address" -f value)
(overcloud) [stack@undercloud ~]$ openstack server add floating ip test-instance $FIP</code></pre></div></div></li><li><p>Verify that the floating IP address is assigned to the instance:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ openstack server show test-instance -f json -c addresses</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="json language-json">{
  "addresses": "private=172.16.1.162, 10.0.0.117"
}</code></pre></div></div>
<div class="ulist"><ul><li><p>Expect the <code>addresses</code> field to show the fixed and floating IP addresses assigned to the instance.</p></li></ul></div></li></ol></div></div>
<div class="sect2"><h3 id="_connect_to_test_instance">5.3. Connect to Test Instance</h3><div class="paragraph"><p>The <code>workstation</code> node in the lab environment is configured with a network interface to VLAN 10 on the <code>datacentre</code> network. Recall that VLAN 10 was used when you created the <code>public</code> network in the overcloud. This setup allows you to use <code>workstation</code> as an external client to check connectivity with floating IP addresses allocated out of the <code>public-subnet</code> allocation pool.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Open a new SSH session to <code>workstation</code>.</p></li><li><p>Ping the instance using the assigned floating IP to verify connectivity over the external network:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(overcloud) [stack@undercloud ~]$ ping -c3 $FIP</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">PING 10.0.0.105 (10.0.0.105) 56(84) bytes of data.
64 bytes from 10.0.0.105: icmp_seq=1 ttl=63 time=3.06 ms
64 bytes from 10.0.0.105: icmp_seq=2 ttl=63 time=0.918 ms
64 bytes from 10.0.0.105: icmp_seq=3 ttl=63 time=0.616 ms

--- 10.0.0.105 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2001ms
rtt min/avg/max/mdev = 0.616/1.533/3.065/1.090 ms</code></pre></div></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="icon-note" title="Note"></i></td><td class="content">OVN may take some time to establish a data path to the instance. It may cause a loss of the first packet in the packet stream. You should not see any packet loss if you ping the instance again.</td></tr></table></div></li><li><p>Connect to the instance using its floating IP:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">(user1) [stack@undercloud ~]$ ssh cirros@$FIP</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">The authenticity of host '10.0.0.105 (&lt;no hostip for proxy command&gt;)' can't be established.
ECDSA key fingerprint is SHA256:sWabETA1lVRvAn7NcP0aTsJM/ux45LIqSAuMd7pWLgY.
ECDSA key fingerprint is MD5:62:0c:e4:ff:42:c0:8e:f1:eb:6d:70:b0:06:57:29:98.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '10.0.0.105' (ECDSA) to the list of known hosts.
cirros@10.0.0.105's password:    <i class="conum" data-value="1"></i><b>(1)</b>
$</code></pre></div></div>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Password is <code>gocubsgo</code></td></tr></table></div></li><li><p>Examine the <code>/etc/resolv.conf</code> file in the <code>test-instance</code>:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">$ cat /etc/resolv.conf</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">nameserver 8.8.4.4</code></pre></div></div>
<div class="ulist"><ul><li><p>Expect to see <code>nameserver</code> with the same IP address that you used in the <code>dns-nameserver</code> parameter when you created <code>private-subnet</code> (<code>8.8.4.4</code>).</p></li></ul></div></li><li><p>Verify connectivity from the instance to the Internet:</p><div class="listingblock"><div class="content"><pre class="highlight"><code class="sh language-sh">$ ping -c3 redhat.com</code></pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="highlight nowrap"><code class="texinfo language-texinfo">PING redhat.com (209.132.183.105): 56 data bytes
64 bytes from 209.132.183.105: seq=0 ttl=239 time=52.095 ms
64 bytes from 209.132.183.105: seq=1 ttl=239 time=52.038 ms
64 bytes from 209.132.183.105: seq=2 ttl=239 time=52.265 ms

--- redhat.com ping statistics ---
3 packets transmitted, 3 packets received, 0% packet loss
round-trip min/avg/max = 52.038/52.132/52.265 ms</code></pre></div></div>
<div class="ulist"><ul><li><p>Similar output confirms that you successfully installed and configured your overcloud.</p></li></ul></div></li></ol></div></div></div></div>
<div class="sect1"><h2 id="_review_neutron_configuration_with_ovn">6. Review Neutron Configuration with OVN</h2><div class="sectionbody"><div class="sect2"><h3 id="_ovn_on_controller">6.1. OVN on Controller</h3><div class="olist arabic"><ol class="arabic"><li><p>Login to the overcloud controller node using the <code>heat-admin</code> user.</p></li><li><p>Review the mechanism drivers configured in the OpenStack installation:</p><div class="listingblock"><div class="content"><pre class="nowrap">(overcloud) [stack@undercloud ~]$ ssh heat-admin@overcloud-controller-0.ctlplane
[heat-admin@overcloud-controller-0 ~]$ sudo crudini --get  /var/lib/config-data/puppet-generated/neutron/etc/neutron/plugins/ml2/ml2_conf.ini ml2 mechanism_drivers</pre></div></div>
<div class="listingblock"><div class="title">Expected Output</div><div class="content"><pre class="nowrap">ovn</pre></div></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="icon-note" title="Note"></i></td><td class="content">The Neutron service is containerized and the specified <code>ml2_conf.ini</code> file in the host file system bound to the <code>/etc/neutron/plugins/ml2/ml2_conf.ini</code> path inside the container.</td></tr></table></div></li><li><p>Check the <code>tenant_network_types</code> parameter configured in the ML2 configuration file:</p><div class="listingblock"><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ sudo crudini --get  /var/lib/config-data/puppet-generated/neutron/etc/neutron/plugins/ml2/ml2_conf.ini ml2 tenant_network_types</pre></div></div>
<div class="listingblock"><div class="title">Expected Output</div><div class="content"><pre class="nowrap">geneve,vlan</pre></div></div></li><li><p>Review the OVN service containers running at the controller node:</p><div class="listingblock"><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ sudo podman ps -f name=ovn</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">CONTAINER ID  IMAGE                                                                              COMMAND               CREATED      STATUS          PORTS  NAMES
7756d99696d3  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-ovn-controller:16.0-76  kolla_start           4 hours ago  Up 4 hours ago         ovn_controller
f37bac84190d  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-ovn-northd:16.0-81      /bin/bash /usr/lo...  4 hours ago  Up 4 hours ago         ovn-dbs-bundle-podman-0</pre></div></div></li><li><p>Check the listening socket of the OVN Northbound database in the control node:</p><div class="listingblock"><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ ss -4l | grep 6641</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">tcp   LISTEN  0       10         172.17.0.244:6641                 0.0.0.0:*</pre></div></div></li><li><p>Check the listening socket of the OVN Southbound database in the the control node:</p><div class="listingblock"><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ ss -4l | grep 6642</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">tcp   LISTEN  0       10         172.17.0.244:6642                 0.0.0.0:*</pre></div></div></li><li><p>Check the network agents in the OpenStack installation with the OVN mechanism driver:</p><div class="listingblock"><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ exit
(overcloud) [stack@undercloud ~]$ openstack network agent list</pre></div></div>
<div class="listingblock"><div class="content"><pre class="nowrap">+--------------------------------------+----------------------+-------------------------------------+-------------------+-------+-------+-------------------------------+
| ID                                   | Agent Type           | Host                                | Availability Zone | Alive | State | Binary                        |
+--------------------------------------+----------------------+-------------------------------------+-------------------+-------+-------+-------------------------------+
| 78654eb1-e668-47f8-93e4-89ba9b8478a7 | OVN Controller agent | overcloud-novacompute-0.localdomain | n/a               | :-)   | UP    | ovn-controller                |
| b2679f84-7299-4760-92ee-d1f18e544dc2 | OVN Metadata agent   | overcloud-novacompute-0.localdomain | n/a               | :-)   | UP    | networking-ovn-metadata-agent |
| b393a83b-e9f0-4746-9362-9258e03f81c6 | OVN Controller agent | overcloud-novacompute-1.localdomain | n/a               | :-)   | UP    | ovn-controller                |
| 48690e29-1bd0-4e7b-83b4-bd89395fdfef | OVN Metadata agent   | overcloud-novacompute-1.localdomain | n/a               | :-)   | UP    | networking-ovn-metadata-agent |
| 85688d86-d3e6-46ff-9625-2e067b5eec1d | OVN Controller agent | overcloud-controller-2.localdomain  | n/a               | :-)   | UP    | ovn-controller                |
| 2e6aa58c-2d48-43a4-b71a-6a7cf5b58ab7 | OVN Controller agent | overcloud-controller-0.localdomain  | n/a               | :-)   | UP    | ovn-controller                |
| 1601a0e3-2d7d-40ef-b28b-757c442ff7b5 | OVN Controller agent | overcloud-controller-1.localdomain  | n/a               | :-)   | UP    | ovn-controller                |
+--------------------------------------+----------------------+-------------------------------------+-------------------+-------+-------+-------------------------------+</pre></div></div></li></ol></div></div>
<div class="sect2"><h3 id="_ovn_on_compute_nodes">6.2. OVN on Compute Nodes</h3><div class="olist arabic"><ol class="arabic"><li><p>Check the OVN service containers on the compute node:</p><div class="listingblock"><div class="content"><pre class="nowrap">(overcloud) [stack@undercloud ~]$ ssh heat-admin@overcloud-novacompute-0.ctlplane
[heat-admin@overcloud-novacompute-0 ~]$ sudo podman ps -f name=ovn</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">CONTAINER ID  IMAGE                                                                                          COMMAND               CREATED         STATUS             PORTS  NAMES
d463ad99607a  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-neutron-metadata-agent-ovn:16.0-78  /bin/bash -c HAPR...  29 minutes ago  Up 29 minutes ago         neutron-haproxy-ovnmeta-ed28229a-a30a-4d70-b515-ca9acffff8a8
f555b06d9700  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-neutron-metadata-agent-ovn:16.0-78  kolla_start           4 hours ago     Up 4 hours ago            ovn_metadata_agent
c29e18c19c18  undercloud.ctlplane.localdomain:8787/rhosp-rhel8/openstack-ovn-controller:16.0-76              kolla_start           4 hours ago     Up 4 hours ago            ovn_controller</pre></div></div>
<div class="ulist"><ul><li><p>When OpenStack Networking is configured with OVN, a compute node runs OVN controller and metadata agent.</p></li></ul></div></li><li><p>Check the <em>network namespaces</em> created in the compute node:</p><div class="listingblock"><div class="content"><pre class="nowrap">[heat-admin@overcloud-novacompute-0 ~]$ sudo ip netns</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">ovnmeta-ed28229a-a30a-4d70-b515-ca9acffff8a8 (id: 0)</pre></div></div>
<div class="paragraph"><p>Please note that, you find only the OVN metadata namespaces in the compute nodes.</p></div></li></ol></div></div></div></div>
<div class="sect1"><h2 id="_packet_switching_and_tracing">7. Packet Switching and Tracing</h2><div class="sectionbody"><div class="paragraph"><p>At each step, we will take a look at how the features in question work from OpenStack’s Neutron networking layer at the top to the data plane layer at the bottom.</p></div>
<div class="paragraph"><p>When OpenStack Networking is configured with OVN, the following layers and the software components are involved from the highest to lowest level:</p></div>
<div class="paragraph"><p><strong>OpenStack Neutron:</strong> OpenStack Neutron as the top level in the system is the authoritative source of the virtual network configuration.</p></div>
<div class="paragraph"><p>You will use the <code>openstack</code> client to observe and modify Neutron and other OpenStack configuration.</p></div>
<div class="paragraph"><p><strong>networking-ovn:</strong> The Neutron driver that interfaces with OVN and translates the internal Neutron representation of the virtual network into OVN’s representation and pushes that representation down the OVN northbound database.</p></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="icon-note" title="Note"></i></td><td class="content">It rarely worth distinguishing Neutron from <code>networking-ovn</code>, so we usually don’t break out this layer separately.</td></tr></table></div>
<div class="paragraph"><p><strong>OVN Northbound database, a.k.a NB DB:</strong> This is an instance of OVSDB, a simple general-purpose database that is used for multiple purposes in Open vSwitch and OVN. The NB DB’s schema is in terms of networking concepts such as switches and routers. The NB DB serves the purpose that in other systems might be filled by some kind of API; for example, in place of calling an API to create or delete a logical switch, <code>networking-ovn</code> performs these operations by inserting or deleting a row in the NB DB’s <code>Logical_Switch</code> table.</p></div>
<div class="paragraph"><p>You will use OVN’s <code>ovn-nbctl</code> utility to observe the NB DB. (You won’t directly modify data at this layer or below. Because configuration trickles down from Neutron through the stack, the right way to make changes is to use the <code>openstack</code> utility or another OpenStack interface and then wait for them to percolate through to lower layers.)</p></div>
<div class="paragraph"><p><strong>The ovn-northd daemon:</strong>  A program that runs centrally and translates the NB DB’s network representation into the lower-level representation used by the OVN Southbound database in the next layer. The details of this daemon are usually not of interest, although without it OVN will not work. This lab does not often mention it.</p></div>
<div class="paragraph"><p><strong>The OVN Southbound database, aka SB DB:</strong>  This is also an OVSDB database. Its schema is very different from the NB DB. Instead of familiar networking concepts, the SB DB defines the network in terms of collections of match-action rules called <em>logical flows</em>, which while similar in concept to OpenFlow flows, use logical concepts such as virtual machine instances, in place of physical concepts like physical Ethernet ports.</p></div>
<div class="paragraph"><p>You will use OVN’s <code>ovn-sbctl</code> utility to observe the SB DB.</p></div>
<div class="paragraph"><p><strong>The ovn-controller daemon:</strong> A copy of <code>ovn-controller</code> runs on each hypervisor. It reads logical flows from the SB DB, translates them into OpenFlow flows, and sends them to Open vSwitch’s <code>ovs-vswitchd</code> daemon. Like <code>ovn-northd</code>, usually the details of what this daemon are not of interest, even though it’s important to the operation of the system.</p></div>
<div class="paragraph"><p><strong>ovs-vswitchd:</strong>  This program runs on each hypervisor. It is the core of Open vSwitch, which processes packets according to the OpenFlow flows set up by <code>ovn-controller</code>.</p></div>
<div class="paragraph"><p><strong>Open vSwitch datapath:</strong> This is essentially a cache designed to accelerate packet processing. Open vSwitch includes a few different datapaths but OVN installations typically use one based on the Open vSwitch Linux kernel module.</p></div>
<div class="sect2"><h3 id="_switching">7.1. Switching</h3><div class="paragraph"><p>Switching is the basis of networking in the real world and in virtual networking as well. OpenStack calls its concept of a virtual switch a <em>network</em>, and OVN calls its corresponding concept a <em>logical switch</em>.</p></div>
<div class="olist arabic"><ol class="arabic"><li><p>Use the <code>ovn-nbctl show</code> command on the controller node to see an overview of what is in the NB DB (the OVN northbound database is listening on port 6641):</p><div class="listingblock"><div class="content"><pre class="nowrap">[heat-admin@overcloud-novacompute-0 ~]$ logout
(overcloud) [stack@undercloud ~]$ ssh heat-admin@overcloud-controller-0.ctlplane
[heat-admin@overcloud-controller-0 ~]$ IP=$(ss -4l | grep 6641|awk '{print $5}'|cut -d":" -f1)
[heat-admin@overcloud-controller-0 ~]$ sudo podman exec -ti ovn_controller ovn-nbctl --db=tcp:$IP:6641 show</pre></div></div>
<div class="listingblock"><div class="title">Sample output</div><div class="content"><pre class="nowrap">switch f1556c80-9f1e-415d-9d61-796bf1a3e8f3 (neutron-3f52c905-ee47-4786-b717-868e842fe273) (aka public)
    port e34ad745-5359-4f0f-956d-1923420accf3
        type: localport
        addresses: ["fa:16:3e:b6:b3:04"]
    port provnet-3f52c905-ee47-4786-b717-868e842fe273
        type: localnet
        tag: 10
        addresses: ["unknown"]
    port 04a242ae-46bc-4df3-8653-3ef09cae1956
        type: router
        router-port: lrp-04a242ae-46bc-4df3-8653-3ef09cae1956
switch 33d78a05-318c-4db3-9c47-87d7351310ab (neutron-c854a369-5169-4765-98d6-8965bb86974f) (aka private)
    port fa0d8d2a-b196-42fa-9537-766481b1d081
        type: router
        router-port: lrp-fa0d8d2a-b196-42fa-9537-766481b1d081
    port 65fdfe10-05eb-46b4-b205-4c9bc2a041de
        addresses: ["fa:16:3e:ba:12:5a 172.16.1.162"]
    port 2f2c6a01-94db-4ed2-8855-ba188bc89a10
        type: localport
        addresses: ["fa:16:3e:ee:bd:37 172.16.1.2"]
router d7499585-77e4-4c99-be30-492b08712ba5 (neutron-81e92740-4449-4d6c-b504-76a10c39c703) (aka router1)
    port lrp-fa0d8d2a-b196-42fa-9537-766481b1d081
        mac: "fa:16:3e:b8:eb:cd"
        networks: ["172.16.1.1/24"]
    port lrp-04a242ae-46bc-4df3-8653-3ef09cae1956
        mac: "fa:16:3e:04:bb:00"
        networks: ["10.0.0.190/24"]
        gateway chassis: [78654eb1-e668-47f8-93e4-89ba9b8478a7 2e6aa58c-2d48-43a4-b71a-6a7cf5b58ab7 1601a0e3-2d7d-40ef-b28b-757c442ff7b5 b393a83b-e9f0-4746-9362-9258e03f81c6 85688d86-d3e6-46ff-9625-2e067b5eec1d]
    nat 0ae3a200-58da-42d6-86f3-fbb527155583
        external ip: "10.0.0.117"
        logical ip: "172.16.1.162"
        type: "dnat_and_snat"
    nat 2c9eee18-c36d-4832-93e5-3a667d6ec190
        external ip: "10.0.0.190"
        logical ip: "172.16.1.0/24"
        type: "snat"</pre></div></div>
<div class="paragraph"><p>This output shows that OVN has two switches (for networks <code>public</code> and <code>private</code>) and one router (for OSP router named <code>router1</code>).</p></div></li><li><p>Get more details about logical ports associated with instances <code>a</code> and <code>b</code> from the <code>Logical_Switch_Port</code> table in the OVS Northbound DB:</p><div class="listingblock"><div class="title">[Controller node]</div><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ sudo podman exec -ti ovn_controller ovn-nbctl --db=tcp:$IP:6641 list logical_switch_port</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">_uuid               : 369769a1-1084-43d4-921f-74c0b8664d2b
addresses           : ["fa:16:3e:ba:12:5a 172.16.1.162"]
dhcpv4_options      : c6a85386-0d7c-4a1d-87fd-d151857a4643
dhcpv6_options      : []
dynamic_addresses   : []
enabled             : true
external_ids        : {"neutron:cidrs"="172.16.1.162/24", "neutron:device_id"="ff254845-c0c4-42cd-8ae8-1c5d0ff84a12", "neutron:device_owner"="compute:nova", "neutron:network_name"="neutron-c854a369-5169-4765-98d6-8965bb86974f", "neutron:port_fip"="10.0.0.117", "neutron:port_name"="", "neutron:project_id"="1206c1b5fe644711ad8103f90d312d76", "neutron:revision_number"="4", "neutron:security_group_ids"="c39b34d9-9cd0-4192-8b70-c0e3b17cab25"}
ha_chassis_group    : []
name                : "65fdfe10-05eb-46b4-b205-4c9bc2a041de"
options             : {requested-chassis="overcloud-novacompute-0.localdomain"}
parent_name         : []
port_security       : ["fa:16:3e:ba:12:5a 172.16.1.162"]
tag                 : []
tag_request         : []
type                : ""
&lt;&lt;OMITTED&gt;&gt;</pre></div></div>
<div class="paragraph"><p>Each port has addressing information, port security enabled, and a pointer to DHCP configuration.</p></div>
<div class="paragraph"><p>Using <code>ovn-northd</code>, OVN translates the NB DB’s high-level switch and router concepts into lower-level concepts of <em>logical datapaths</em> and <em>logical flows</em>. There is one logical datapath for each logical switch or router.</p></div></li><li><p>List logical datapaths defined in the OVN Southbound DB (the OVN Southbound database listens on port 6642):</p><div class="listingblock"><div class="title">[Controller node]</div><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ sudo podman exec -ti ovn_controller ovn-sbctl --db=tcp:$IP:6642 list datapath_binding</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">_uuid               : e2fa34b1-623e-4ab8-a552-dc56e5016ab8
external_ids        : {logical-switch="f1556c80-9f1e-415d-9d61-796bf1a3e8f3", name="neutron-3f52c905-ee47-4786-b717-868e842fe273", "name2"=public}
tunnel_key          : 1

_uuid               : ed28229a-a30a-4d70-b515-ca9acffff8a8
external_ids        : {logical-switch="33d78a05-318c-4db3-9c47-87d7351310ab", name="neutron-c854a369-5169-4765-98d6-8965bb86974f", "name2"=private}
tunnel_key          : 2

_uuid               : 9305172b-72ab-43d7-a0bf-f7d140fcf87b
external_ids        : {logical-router="d7499585-77e4-4c99-be30-492b08712ba5", name="neutron-81e92740-4449-4d6c-b504-76a10c39c703", "name2"="router1"}
tunnel_key          : 4</pre></div></div>
<div class="ulist"><ul><li><p>Notice that the logical datapath corresponds to the logical switch defined in the OVS Northbound DB and to the Neutron network with specified network id and network name.</p></li></ul></div></li><li><p>List the logical flow from the OVN Southbound DB related to the <code>n1</code> datapath:</p><div class="listingblock"><div class="title">[Controller node]</div><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ sudo podman exec -ti ovn_controller ovn-sbctl --db=tcp:$IP:6642 lflow-list private</pre></div></div>
<div class="listingblock"><div class="title">Sample Output</div><div class="content"><pre class="nowrap">Datapath: "neutron-c854a369-5169-4765-98d6-8965bb86974f" aka "private" (ed28229a-a30a-4d70-b515-ca9acffff8a8)  Pipeline: ingress

(...)</pre></div></div>
<div class="paragraph"><p>You may glance through the flows. Packets that egress a VM into the logical switch travel through the flow table’s <strong>ingress</strong> pipeline starting from table 0. At each table, the switch finds the highest-priority logical flow that matches and executes its actions, or if there’s no matching flow then the packet is dropped. The <code>ovn-sb</code> man-page gives all the details, but with a little thought it’s possible to guess a lot without reading the man-page. For example, consider the flows in ingress pipeline table 0, which are the first flows encountered by a packet traversing the switch:</p></div>
<div class="listingblock"><div class="content"><pre>Datapath: "neutron-dcd9af66-47e8-4016-8fb4-9911bc49ceb5" aka "n1" (95943d31-1bf2-4bcc-b4c4-69bb437b2c8a)  Pipeline: ingress
  table=0 (ls_in_port_sec_l2  ), priority=100  , match=(eth.src[40]), action=(drop;)
  table=0 (ls_in_port_sec_l2  ), priority=100  , match=(vlan.present), action=(drop;)
  table=0 (ls_in_port_sec_l2  ), priority=50   , match=(inport == "2f2c6a01-94db-4ed2-8855-ba188bc89a10"), action=(next;)
  table=0 (ls_in_port_sec_l2  ), priority=50   , match=(inport == "65fdfe10-05eb-46b4-b205-4c9bc2a041de" &amp;&amp; eth.src == {fa:16:3e:ba:12:5a}), action=(next;)
  table=0 (ls_in_port_sec_l2  ), priority=50   , match=(inport == "fa0d8d2a-b196-42fa-9537-766481b1d081"), action=(next;)
</pre></div></div>
<div class="paragraph"><p>The first two flows, with priority 100, immediately drop two kinds of invalid packets: those with a multicast or broadcast Ethernet source address (since multicast is only for packet destinations) and those with a VLAN tag (because OVN doesn’t support VLAN tags inside logical networks yet). Two lines with the <code>inport</code> IDs and <code>eth.src</code> MAC addresses implement L2 port security: they advance to the next table for packets with the correct Ethernet source addresses for their ingress ports. A packet that does not match any flow is implicitly dropped, so there’s no need for flows to deal with mismatches.</p></div>
<div class="paragraph"><p>The logical flow table includes many other flows, some of which we will look at later. For now, it’s most worth looking at ingress <strong>table 16</strong>:</p></div>
<div class="listingblock"><div class="content"><pre class="nowrap">  table=17(ls_in_l2_lkup      ), priority=110  , match=(eth.dst == 0e:22:66:62:9c:b2), action=(handle_svc_check(inport);)
  table=17(ls_in_l2_lkup      ), priority=80   , match=(eth.src == { fa:16:3e:b8:eb:cd} &amp;&amp; (arp.op == 1 || nd_ns)), action=(outport = "_MC_flood"; output;)
  table=17(ls_in_l2_lkup      ), priority=75   , match=(flags[1] == 0 &amp;&amp; arp.op == 1 &amp;&amp; arp.tpa == { 172.16.1.1, 10.0.0.117}), action=(outport = "fa0d8d2a-b196-42fa-9537-766481b1d081"; output;)
  table=17(ls_in_l2_lkup      ), priority=75   , match=(flags[1] == 0 &amp;&amp; nd_ns &amp;&amp; nd.target == { fe80::f816:3eff:feb8:ebcd}), action=(outport = "fa0d8d2a-b196-42fa-9537-766481b1d081"; output;)
  table=17(ls_in_l2_lkup      ), priority=70   , match=(eth.mcast), action=(outport = "_MC_flood"; output;)
  table=17(ls_in_l2_lkup      ), priority=50   , match=(eth.dst == fa:16:3e:b8:eb:cd), action=(outport = "fa0d8d2a-b196-42fa-9537-766481b1d081"; output;)
  table=17(ls_in_l2_lkup      ), priority=50   , match=(eth.dst == fa:16:3e:ba:12:5a), action=(outport = "65fdfe10-05eb-46b4-b205-4c9bc2a041de"; output;)
  table=17(ls_in_l2_lkup      ), priority=50   , match=(eth.dst == fa:16:3e:ee:bd:37), action=(outport = "2f2c6a01-94db-4ed2-8855-ba188bc89a10"; output;)</pre></div></div>
<div class="paragraph"><p>The flow matching "eth.mcast" in table 27 checks whether the packet is an Ethernet multicast or broadcast and, if so, outputs it to a special port that egresses to every logical port (other than the ingress port). Otherwise the packet is output to the port corresponding to its Ethernet destination address. Packets addressed to any other Ethernet destination are implicitly dropped.</p></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="icon-note" title="Note"></i></td><td class="content">It’s common for an OVN logical switch to know all the MAC addresses supported by its logical ports, like this one. That’s why there’s no logic here for MAC learning or flooding packets to unknown MAC addresses. OVN does support unknown MAC handling but that’s not in play in our scenario.</td></tr></table></div></li><li><p>If you’re interested in the details for the multicast group, you can run a command like the following and then look at the row for the correct datapath:</p><div class="listingblock"><div class="content"><pre class="nowrap">[heat-admin@overcloud-controller-0 ~]$ sudo podman exec -ti ovn_controller ovn-sbctl --db=tcp:$IP:6642 find multicast_group name=_MC_flood</pre></div></div></li></ol></div></div></div></div></div><div id="footer"><div id="footer-text"><br>Build Version: 1.6.7   :   Last updated 2020-09-20 04:59:02 EDT</div></div></body></html>